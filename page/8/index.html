<!doctype html>
<html class="theme-next use-motion ">
<head>
  

<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






  <link rel="stylesheet" type="text/css" href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5"/>




<link rel="stylesheet" type="text/css" href="/css/main.css?v=0.4.5.1"/>


    <meta name="description" content="一只在迈向机器学习道路上狂奔的程序猿." />



  <meta name="keywords" content="Hexo,next" />





  <link rel="shorticon icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.1" />


<meta name="description" content="一只在迈向机器学习道路上狂奔的程序猿.">
<meta property="og:type" content="website">
<meta property="og:title" content="DannyLee">
<meta property="og:url" content="http://dannylee1991.github.io/page/8/index.html">
<meta property="og:site_name" content="DannyLee">
<meta property="og:description" content="一只在迈向机器学习道路上狂奔的程序猿.">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DannyLee">
<meta name="twitter:description" content="一只在迈向机器学习道路上狂奔的程序猿.">


<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: '',
    sidebar: 'post'
  };
</script>

<!--baidu统计-->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?2f967e5ec4f276411160d27aeace7722";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

  <title> DannyLee </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  



  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><h1 class="site-meta">
  <span class="logo-line-before"><i></i></span>
  <a href="/" class="brand" rel="start">
      <span class="logo">
        <i class="icon-next-logo"></i>
      </span>
      <span class="site-title">DannyLee</span>
  </a>
  <span class="logo-line-after"><i></i></span>
</h1>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu menu-left">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon icon-next-home"></i> <br />
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            <i class="menu-item-icon icon-next-categories"></i> <br />
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            <i class="menu-item-icon icon-next-archives"></i> <br />
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            <i class="menu-item-icon icon-next-tags"></i> <br />
            标签
          </a>
        </li>
      

      
      
        <li class="menu-item menu-item-search">
          <a href="#" class="st-search-show-outputs">
            <i class="menu-item-icon icon-next-search"></i> <br />
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'ss9-_Hsd4DyhyGw4m99P','2.0.0');
</script>



    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content"> 
  <section id="posts" class="posts-expand">
    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/03/13/人工智能五子棋实现原理/" itemprop="url">
                人工智能五子棋实现原理
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2016-03-13T20:30:55+08:00" content="2016-03-13">
            2016-03-13
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/人工智能/" itemprop="url" rel="index">
                  <span itemprop="name">人工智能</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2016/03/13/人工智能五子棋实现原理/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2016/03/13/人工智能五子棋实现原理/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><p>这两天Alpha go 和李世石的围棋大战被炒的沸沸扬扬，今天李世石终于为人类扳回了挽回脸面的一局，不管是不是Alpha go故意放水，也不管是不是李世石找到了Alpha go的bug，总之这次围棋大战，是深度学习领域的一个影响深远的重大事件，更多的行业将开始更深入的关注人工智能深度学习领域了。个人认为，人工智能领域必定会成为即移动互联网之后的又一个更大的趋势。</p>
<p>好了，废话不多说，今天主要是展示一个这两天实现的一个五子棋AI，实现方式很简陋，完全不能和阿法狗相提并论，和大家分享的同时也当作自己练手，写的不好请多多包含。</p>
<p>项目地址见文章末尾。</p>
<hr>
<p>关于棋盘棋子的实现逻辑我就不多说了，大家可以看源码，并不复杂，说说AI部分的实现吧：</p>
<p>我的实现思路是：</p>
<p>当玩家走下一步棋的时候，AI要考虑两个因素：</p>
<p>1.走对自己获得胜利最有利的点（说白了就是最接近5子连线的点）</p>
<p>2.堵对对方获得胜利最有利的点（说白了就是堵对方的棋子）</p>
<p>做到这两步就能实现一个初级阶段的人工智能了。</p>
<p>那么接下来就讲讲<strong>关于计算获得胜利最有利的点</strong>是如何计算出来的：</p>
<p>其实原理也比较简单：</p>
<p>在棋盘上计算每个空白位置的点的4个方向（横向，纵向，左上角到右下角方向，右上角到左下角方向）每个有可能获胜的方向所连成的以当前棋子为出发点的长度为获胜棋子数量的（五子棋为5）中途没有被敌方棋子阻挡的所覆盖的己方棋子数。（是不是很绕，反正如果是我看到会被绕晕，没看懂不要紧，下面有栗子，对是栗子）得出每个方向上最大棋子数之后，然后取出每个棋子四个值里最大的值作为获胜权重（win_weight）。</p>
<p>以下图为例：</p>
<p><img src="/img/ai_01_01.png" alt=""></p>
<p>这是一个6x6的棋盘，现在我们来计算一下白子获胜的权重：</p>
<p><img src="/img/ai_01_02.png" alt=""></p>
<p>那么权重是如何计算的呢？举个栗子来说明吧：</p>
<p><img src="/img/ai_01_04.png" alt=""></p>
<p>首先定义这个棋盘坐标系x方向是向右的，y方向是向下的，左上角的位置是(0,0)，(x,y)可以定义一个棋子的坐标。定义xy方向为左上角到右下角方向，yx方向为右上角到左下角方向。</p>
<p>（0，0）点的权重计算：首先判断这一点没有连成5子的可能性，权重为0。</p>
<p>（0，2）点的权重计算：首先判断这一点没有连成5子的可能性，权重为0。</p>
<p>（0，3）点的权重计算：首先判断这一点有连成5子的可能性，接下来x轴方向上经过当前位置可连成五子的棋子有0个，y轴方向上经过当前位置可连成五子的棋子有1个，xy方向不存在连成5子的可能性，yx方向上不存在连成5子的可能性，四个方向中，取最大值，结果为1，那么当前点的获胜权重为1。</p>
<p>以此类推，可以得出所有空白点的白字获胜权重。</p>
<p>那么我们下一步让AI直接走获胜权重最大的点是不是就可以了呢？</p>
<p>非也非也。我们不能只考虑自己获胜，也要考虑防止对手获胜。那么如何防止对手获胜呢？我的方式就是走对手获胜权重最高的位置就可以了，就素堵住对方的棋子（传说中的走别人的路，让别人无路可走）。</p>
<p>同样的方式，我们可以求得黑子的获胜权重(win_weight)分布：</p>
<p><img src="/img/ai_01_03.png" alt=""></p>
<p>可以看出在(0,0),(0,2),(0,4),(0,5)这几个点是黑子获胜概率最大的点。白子走在这些点就可以堵住黑棋。</p>
<p>好的我们得到了白子赢得胜利最有利的点，以及白子阻止黑子获得胜利最有利的点，那么问题来了：我们到底该如何选择具体走哪个点呢？</p>
<p>有个比较粗劣的实现方式，就是将这两个权重相加，相当于将这两个条件同等来对待，认为对白子获得胜利的影响重要性是相同的，然后取加起来权重最高的点。</p>
<p>但实际情况是这两个条件对获得胜利的影响是不等价的，我们要想办法来得到描述这两者之间关系的公式。这里的实现方式有：</p>
<ul>
<li>1.通过试探法（就是瞎猜）</li>
</ul>
<p>尝试去将这两个参数相乘，取得的结果作为最终权重，来进行取值。</p>
<p>或者 白子的获胜权重 + R * 黑子的获胜权重， R是一个系数，我们需要通过不断的调整来接近最好的结果。</p>
<p>通过不断的尝试，来将最接近答案的公式猜出来。</p>
<ul>
<li>2.通过条件分情况来判断</li>
</ul>
<p>比如下过五子棋的人都知道一个常识：当对手有三子相连，是一个很危险的情况，如果自己目前没有三子相连，那么你应该去堵住对方的连在一起的三子。那么就可以判断，当对手的win_weight &gt;= 3 的时候，加入对手权重的判断，其余情况不考虑对手获胜权重。</p>
<ul>
<li>3.通过机器学习来让机器理解人类走棋的逻辑</li>
</ul>
<p>构建机器学习算法，通过大量的训练数据来训练机器，从而让机器通过历史数据来算出下一步该怎么走</p>
<p>我认为第三种方式是最理想的实现，因为前面两种无法覆盖到所有的情况。不过目前我只是做了第一种的简单的实现，接下来会考虑逐渐完善机器学习算法。</p>
<p>好了，这就是我实现五子棋AI的一个大致思路，有很多人问我什么是机器学习，我觉得在这里可以用一个简单的比喻告诉大家：</p>
<p>人生会经历很多事情，当你年幼无知的时候，可能会由于涉世未深而犯很多次错误，当你渐渐长大了，成熟了，经历的事情多了起来，尤其是当你犯错的时候，有人对你指出这样做是错的，你犯错误的次数就会慢慢减少，这个过程就像是一个机器学习的过程。</p>
<p>机器积累训练数据之前，很容易出错，经过大量的训练数据训练之后，就会做的越来越好，这就是机器学习。</p>
<p>好了，今天就写到这里，文笔不好，请多多见谅。</p>
<p>欢迎交流，互相学习，互相进步，转载请表明出处。</p>
<p>项目地址：<a href="https://github.com/DannyLee1991/AI_wuziqi" target="_blank" rel="external">https://github.com/DannyLee1991/AI_wuziqi</a></p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/03/06/R语言（02）绘图/" itemprop="url">
                R语言（02）绘图
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2016-03-06T18:08:55+08:00" content="2016-03-06">
            2016-03-06
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/R/" itemprop="url" rel="index">
                  <span itemprop="name">R</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2016/03/06/R语言（02）绘图/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2016/03/06/R语言（02）绘图/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h2 id="基本图形的绘制">基本图形的绘制</h2><p>在<strong>R语言(01)</strong>中，最后的一个综合训练，我们生成了一部分数据，现在我们就用这些数据为例，来展示R是如何绘制一些图表的。</p>
<h3 id="数据的导入">数据的导入</h3><p>通过读取数据文件，我们可以导入之前产生的数据。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&gt; x=read.table(<span class="string">"mark.txt"</span>,header=<span class="literal">F</span>)</div><div class="line">&gt; x</div><div class="line">          V1  V2 V3  V4</div><div class="line"><span class="number">1</span>   <span class="number">10378001</span>  <span class="number">99</span> <span class="number">73</span>  <span class="number">98</span></div><div class="line"><span class="number">2</span>   <span class="number">10378002</span>  <span class="number">86</span> <span class="number">95</span>  <span class="number">90</span></div><div class="line"><span class="number">3</span>   <span class="number">10378003</span>  <span class="number">98</span> <span class="number">85</span>  <span class="number">84</span></div><div class="line"><span class="number">4</span>   <span class="number">10378004</span>  <span class="number">90</span> <span class="number">81</span> <span class="number">100</span></div><div class="line"><span class="number">5</span>   <span class="number">10378005</span>  <span class="number">81</span> <span class="number">88</span>  <span class="number">96</span></div><div class="line"><span class="number">6</span>   <span class="number">10378006</span>  <span class="number">99</span> <span class="number">63</span>  <span class="number">61</span></div><div class="line"><span class="number">7</span>   <span class="number">10378007</span>  <span class="number">88</span> <span class="number">79</span> <span class="number">100</span></div><div class="line"><span class="number">8</span>   <span class="number">10378008</span>  <span class="number">88</span> <span class="number">92</span>  <span class="number">95</span></div><div class="line"><span class="number">9</span>   <span class="number">10378009</span>  <span class="number">91</span> <span class="number">91</span> <span class="number">100</span></div><div class="line"><span class="keyword">...</span></div></pre></td></tr></table></figure>
<p>其中V1列是学好，V2是均匀分布的成绩数据，V3和V4是正太分布的数据，其中V4对超过100的数据取100。</p>
<h3 id="直方图分析_hist()">直方图分析 hist()</h3><p>绘制直方图函数hist()</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; hist(x$V2)</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_01.png" alt=""></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; hist(x$V3)</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_02.png" alt=""></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; hist(x$V4)</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_03.png" alt=""></p>
<h3 id="散点图_plot()">散点图 plot()</h3><p>散点图绘制函数plot()</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; plot(x$V1,x$V2)</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_04.png" alt=""></p>
<h3 id="柱状图barplot()">柱状图barplot()</h3><p>列联函数table(),柱状图绘制函数barplot()</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; table(x$V2)</div><div class="line"></div><div class="line"> <span class="number">80</span>  <span class="number">81</span>  <span class="number">82</span>  <span class="number">83</span>  <span class="number">84</span>  <span class="number">85</span>  <span class="number">86</span>  <span class="number">87</span>  <span class="number">88</span>  <span class="number">89</span>  <span class="number">90</span>  <span class="number">91</span>  <span class="number">92</span>  <span class="number">93</span>  <span class="number">94</span>  <span class="number">95</span>  <span class="number">96</span>  <span class="number">97</span>  <span class="number">98</span>  <span class="number">99</span> </div><div class="line">  <span class="number">1</span>   <span class="number">5</span>   <span class="number">7</span>   <span class="number">3</span>   <span class="number">3</span>   <span class="number">4</span>   <span class="number">6</span>   <span class="number">8</span>   <span class="number">7</span>   <span class="number">4</span>   <span class="number">7</span>   <span class="number">8</span>   <span class="number">4</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">2</span>   <span class="number">6</span>   <span class="number">2</span>   <span class="number">4</span>   <span class="number">8</span> </div><div class="line"><span class="number">100</span> </div><div class="line">  <span class="number">2</span> </div><div class="line">&gt; barplot(table(x$V2))</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_05.png" alt=""></p>
<h3 id="饼图_pie()">饼图 pie()</h3><p>饼图绘制函数pie()</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; pie(table(x$V2))</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_06.png" alt=""></p>
<h3 id="箱尾图">箱尾图</h3><ul>
<li>箱子的上下横线为样本的25%和75%分为数</li>
<li>箱子中间的横线为样本的中位数</li>
<li>上下延伸的直线称为尾线，尾线的尽头为最高值和最低值</li>
<li>异常值是箱外部的个别与大多数样本相距很远的样本数据</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; boxplot(x$V2,x$V2,x$V3)</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_07.png" alt=""></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; boxplot(x[<span class="number">2</span>:<span class="number">4</span>],col=c(<span class="string">"red"</span>,<span class="string">"green"</span>,<span class="string">"blue"</span>),notch=<span class="literal">T</span>)</div></pre></td></tr></table></figure>
<p>x[2:4] 是值第2到4列</p>
<p>col=c(“red”,”green”,”blue”) 分别指定每个箱尾图的颜色</p>
<p>notch=T 是控制中间的缺口的  主要是让用户更清楚的看到中位线</p>
<p><img src="/img/r_02_08.png" alt=""></p>
<p>水平放置的箱尾图</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; boxplot(x$V2,x$V2,x$V3,horizontal=<span class="literal">T</span>)</div></pre></td></tr></table></figure>
<p>horizontal=T 设置水平显示</p>
<p><img src="/img/r_02_09.png" alt=""></p>
<h3 id="星相图_stars()">星相图 stars()</h3><ul>
<li>每个观测单位的数值表示为一个图形</li>
<li>每个图的每个角表示一个变量，字符串类型会标注在图的下方</li>
<li>角线的长度表达值的大小</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; stars(x[c(<span class="string">"V2"</span>,<span class="string">"V3"</span>,<span class="string">"V4"</span>)])</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_10.png" alt=""></p>
<p>星相图另一种表示：雷达图</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; stars(x[c(<span class="string">"V2"</span>,<span class="string">"V3"</span>,<span class="string">"V4"</span>)],full=<span class="literal">T</span>,draw.segment=<span class="literal">T</span>)</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_11.png" alt=""></p>
<h3 id="人脸图">人脸图</h3><ul>
<li>用五官的宽度和高度来描绘数值</li>
<li>人对脸谱高度敏感和强记忆</li>
<li>适合较少样本的情况</li>
</ul>
<p>安装aplpack包</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="keyword">require</span>(<span class="string">"aplpack"</span>)</div><div class="line">&gt; faces(x[c(<span class="string">"V2"</span>,<span class="string">"V3"</span>,<span class="string">"V4"</span>)])</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_12.png" alt=""></p>
<p>其它脸谱图</p>
<p>安装TeachingDemos包</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="keyword">require</span>(<span class="string">"TeachingDemos"</span>)</div><div class="line">&gt; faces2(x)</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_13.png" alt=""></p>
<h3 id="茎叶图_stem()">茎叶图 stem()</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; stem(x$V3)</div><div class="line"></div><div class="line">  The decimal point is <span class="number">1</span> digit(s) to the right of the |</div><div class="line"></div><div class="line">  <span class="number">6</span> | <span class="number">0233</span></div><div class="line">  <span class="number">6</span> | <span class="number">88</span></div><div class="line">  <span class="number">7</span> | <span class="number">000111222333333</span></div><div class="line">  <span class="number">7</span> | <span class="number">55556677888888888999999999</span></div><div class="line">  <span class="number">8</span> | <span class="number">0000011111112223333333444444</span></div><div class="line">  <span class="number">8</span> | <span class="number">5556666788888899</span></div><div class="line">  <span class="number">9</span> | <span class="number">001224</span></div><div class="line">  <span class="number">9</span> | <span class="number">559</span></div></pre></td></tr></table></figure>
<p>6 | 0233  代表60,62,63,63四个样本数据.茎叶图没有图像输出，是一种高密集型的数据展现形式。</p>
<h3 id="QQ图">QQ图</h3><ul>
<li>可用于判断是否正态分布(服从正态分布的点基本都处于同一直线)</li>
<li>直线的斜率是标准差，截距是均值</li>
<li>点的散布越接近直线，则越接近正态分布</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; qqnorm(x$V2)</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_14.png" alt=""></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; qqline(x$V2)</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_15.png" alt=""></p>
<p>x$V3 数据服从正态分布，点基本都处于同一直线上：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; qqnorm(x$V3)</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_16.png" alt=""></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; qqline(x$V3)</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_17.png" alt=""></p>
<h2 id="图形绘制进阶">图形绘制进阶</h2><h3 id="散点图进一步设置">散点图进一步设置</h3><p>在mac上绘图时显示中文，需要安装以下安装包：</p>
<ul>
<li>showtext</li>
<li>showtextdb</li>
<li>sysfonts</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="keyword">library</span>(sysfonts)</div><div class="line">&gt; <span class="keyword">library</span>(showtext)</div><div class="line">&gt; dev.new() <span class="comment">#如果已打开图形设备，本句可以不用</span></div><div class="line">&gt; showtext.begin()</div></pre></td></tr></table></figure>
<p>加入这几句之后，绘制的图像中就可以正常显示中文了。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; plot(x$V2,x$V3,</div><div class="line">main=<span class="string">"数学分析与线性代数成绩的关系"</span>,</div><div class="line">xlab=<span class="string">"数学分析"</span>,</div><div class="line">ylab=<span class="string">"线性代数"</span>,</div><div class="line">xlim=c(<span class="number">0</span>,<span class="number">100</span>),</div><div class="line">ylim=c(<span class="number">0</span>,<span class="number">100</span>),</div><div class="line">xaxs=<span class="string">"i"</span>, <span class="comment">#Set x axis style as internal</span></div><div class="line">yaxs=<span class="string">"i"</span>, <span class="comment">#Set y axis style as internal</span></div><div class="line">col=<span class="string">"red"</span>, <span class="comment">#Set the color of plotting symbol to red</span></div><div class="line">pch=<span class="number">19</span>) <span class="comment">#Set the plotting symbol to filled dots</span></div></pre></td></tr></table></figure>
<p><img src="/img/r_02_18.png" alt=""></p>
<h3 id="连线图">连线图</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; a=c(<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>)</div><div class="line">&gt; b=c(<span class="number">4</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">12</span>)</div><div class="line">&gt; plot(a,b,type=<span class="string">"l"</span>)</div></pre></td></tr></table></figure>
<p>type=”l” 代表想字母”l”一样，是折现。</p>
<p><img src="/img/r_02_19.png" alt=""></p>
<h3 id="密度图_density()">密度图 density()</h3><p>函数density()</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; plot(density(rnorm(<span class="number">1000</span>)))</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_20.png" alt=""></p>
<h3 id="R中的内置数据集">R中的内置数据集</h3><p>在R中输入data可查看内置数据集：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data()</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_21.png" alt=""></p>
<h3 id="热力图_heatmap()">热力图 heatmap()</h3><p>利用内置的mtcars数据集绘制</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; heatmap(as.matrix(mtcars),</div><div class="line">Rowv=<span class="literal">NA</span>,</div><div class="line">Colv=<span class="literal">NA</span>,</div><div class="line">col=heat.colors(<span class="number">256</span>),</div><div class="line">scale=<span class="string">"column"</span>,</div><div class="line">margins=c(<span class="number">2</span>,<span class="number">8</span>),</div><div class="line">main=<span class="string">"Car characteristics by Model"</span>)</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_22.png" alt=""></p>
<h3 id="Iris(鸢尾花)数据集">Iris(鸢尾花)数据集</h3><ul>
<li>Sepal花萼</li>
<li>Petal花瓣</li>
<li>Species种属</li>
</ul>
<p>这是一个非常著名的数据集，Iris也称鸢尾花卉数据集，是一类多重变量分析的数据集。通过花萼长度，花萼宽度，花瓣长度，花瓣宽度4个属性预测鸢尾花卉属于（Setosa，Versicolour，Virginica）三个种类中的哪一类。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; iris</div><div class="line">    Sepal.Length Sepal.Width Petal.Length Petal.Width    Species</div><div class="line"><span class="number">1</span>            <span class="number">5.1</span>         <span class="number">3.5</span>          <span class="number">1.4</span>         <span class="number">0.2</span>     setosa</div><div class="line"><span class="number">2</span>            <span class="number">4.9</span>         <span class="number">3.0</span>          <span class="number">1.4</span>         <span class="number">0.2</span>     setosa</div><div class="line"><span class="number">3</span>            <span class="number">4.7</span>         <span class="number">3.2</span>          <span class="number">1.3</span>         <span class="number">0.2</span>     setosa</div><div class="line"><span class="number">4</span>            <span class="number">4.6</span>         <span class="number">3.1</span>          <span class="number">1.5</span>         <span class="number">0.2</span>     setosa</div><div class="line"><span class="number">5</span>            <span class="number">5.0</span>         <span class="number">3.6</span>          <span class="number">1.4</span>         <span class="number">0.2</span>     setosa</div><div class="line"><span class="number">6</span>            <span class="number">5.4</span>         <span class="number">3.9</span>          <span class="number">1.7</span>         <span class="number">0.4</span>     setosa</div><div class="line"><span class="number">7</span>            <span class="number">4.6</span>         <span class="number">3.4</span>          <span class="number">1.4</span>         <span class="number">0.3</span>     setosa</div><div class="line"><span class="number">8</span>            <span class="number">5.0</span>         <span class="number">3.4</span>          <span class="number">1.5</span>         <span class="number">0.2</span>     setosa</div><div class="line"><span class="number">9</span>            <span class="number">4.4</span>         <span class="number">2.9</span>          <span class="number">1.4</span>         <span class="number">0.2</span>     setosa</div><div class="line"><span class="number">10</span>           <span class="number">4.9</span>         <span class="number">3.1</span>          <span class="number">1.5</span>         <span class="number">0.1</span>     setosa</div><div class="line"><span class="number">11</span>           <span class="number">5.4</span>         <span class="number">3.7</span>          <span class="number">1.5</span>         <span class="number">0.2</span>     setosa</div><div class="line"><span class="keyword">...</span></div></pre></td></tr></table></figure>
<h3 id="向日葵散点图_sunflowerplot()">向日葵散点图 sunflowerplot()</h3><ul>
<li>用来克服散点图中数据点重叠问题</li>
<li>在有重叠的地方用一朵“向日葵花”的花瓣数目来表示重叠数据个数</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; sunflowerplot(iris[,<span class="number">3</span>:<span class="number">4</span>],col=<span class="string">"gold"</span>,seg.col=<span class="string">"gold"</span>)</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_23.png" alt=""></p>
<h3 id="散点图集">散点图集</h3><ul>
<li>遍历样本中全部的变量配对画出二元图</li>
<li>直观地了解所有变量之间的关系</li>
</ul>
<p>将iris数据集的第1到4列的数据取出，两两组合，形成散点图。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; pairs(iris[,<span class="number">1</span>:<span class="number">4</span>])</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_24.png" alt=""></p>
<p>用plot也可以实现同样的效果</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; plot(iris[,<span class="number">1</span>:<span class="number">4</span>],</div><div class="line">main=<span class="string">"Relationships between </span></div><div class="line">characteristics of iris flowers",</div><div class="line">pch=<span class="number">19</span>,</div><div class="line">col=<span class="string">"blue"</span>,</div><div class="line">cex=<span class="number">0.9</span>)</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_25.png" alt=""></p>
<ul>
<li>利用par()在同一个device输出多个散点图</li>
<li>Par命令博大精深，用于设置绘图参数，help(par)</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; par(mfrow=c(<span class="number">3</span>,<span class="number">1</span>))</div><div class="line">&gt; plot(x$V2,x$V3);plot(x$V3,x$V4);plot(x$V4,x$V1)</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_26.png" alt=""></p>
<p>par(mfrow=c(3,1))   把屏幕划分成3个水平区域<br>plot(x1,x2);plot(x2,x3);plot(x3,x1);    分别将三个散点图显示在这三块区域中。</p>
<blockquote>
<p>如果想深入学习R语言图像绘制，建议对par()函数的文档深入学习，并且学习《R Graphs Cookbook》这本书，会有很大收获的。</p>
</blockquote>
<h3 id="颜色colors()">颜色colors()</h3><p>查看有哪些颜色 colors()</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; colors()</div><div class="line">  [<span class="number">1</span>] <span class="string">"white"</span>                <span class="string">"aliceblue"</span>            <span class="string">"antiquewhite"</span>        </div><div class="line">  [<span class="number">4</span>] <span class="string">"antiquewhite1"</span>        <span class="string">"antiquewhite2"</span>        <span class="string">"antiquewhite3"</span>       </div><div class="line">  [<span class="number">7</span>] <span class="string">"antiquewhite4"</span>        <span class="string">"aquamarine"</span>           <span class="string">"aquamarine1"</span>         </div><div class="line"> [<span class="number">10</span>] <span class="string">"aquamarine2"</span>          <span class="string">"aquamarine3"</span>          <span class="string">"aquamarine4"</span>         </div><div class="line"> [<span class="number">13</span>] <span class="string">"azure"</span>                <span class="string">"azure1"</span>               <span class="string">"azure2"</span>              </div><div class="line"> [<span class="number">16</span>] <span class="string">"azure3"</span>               <span class="string">"azure4"</span>               <span class="string">"beige"</span>               </div><div class="line"> [<span class="number">19</span>] <span class="string">"bisque"</span>               <span class="string">"bisque1"</span>              <span class="string">"bisque2"</span>             </div><div class="line"> [<span class="number">22</span>] <span class="string">"bisque3"</span>              <span class="string">"bisque4"</span>              <span class="string">"black"</span>               </div><div class="line"> [<span class="number">25</span>] <span class="string">"blanchedalmond"</span>       <span class="string">"blue"</span>                 <span class="string">"blue1"</span>               </div><div class="line"> [<span class="number">28</span>] <span class="string">"blue2"</span>                <span class="string">"blue3"</span>                <span class="string">"blue4"</span>               </div><div class="line"> [<span class="number">31</span>] <span class="string">"blueviolet"</span>           <span class="string">"brown"</span>                <span class="string">"brown1"</span>              </div><div class="line"> [<span class="number">34</span>] <span class="string">"brown2"</span>               <span class="string">"brown3"</span>               <span class="string">"brown4"</span>        </div><div class="line"> <span class="keyword">...</span></div></pre></td></tr></table></figure>
<ul>
<li>绘图设备</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; dev.cur() <span class="comment"># 当前图形窗</span></div><div class="line">&gt; dev.list() <span class="comment"># 查看现在所有的图形窗</span></div><div class="line">&gt; dev.next(which=dev.cur()) <span class="comment">#某个图形窗的后一个图形窗</span></div><div class="line">&gt; dev.prev(which=dev.cur()) <span class="comment">#某个图形窗的前一个图形窗</span></div><div class="line">&gt; dev.off(which=dev.cur()) <span class="comment">#关闭某个图形窗</span></div><div class="line">&gt; dev.set(which=dev.next()) <span class="comment">#设置图形窗</span></div><div class="line">&gt; dev.new(<span class="keyword">...</span>) <span class="comment">#开启新的图形窗</span></div><div class="line">&gt; graphics.off() <span class="comment">#关闭整个窗口</span></div></pre></td></tr></table></figure>
<h3 id="三维散点图">三维散点图</h3><p>安装scatterplot3d包</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="keyword">library</span>(scatterplot3d)</div><div class="line">&gt; scatterplot3d(x[<span class="number">2</span>:<span class="number">4</span>])</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_27.png" alt=""></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; x&lt;-y&lt;-seq(-<span class="number">2</span>*pi,<span class="number">2</span>*pi,pi/<span class="number">15</span>)</div><div class="line">&gt; f&lt;-<span class="keyword">function</span>(x,y)sin(x)*sin(y)</div><div class="line">&gt; z&lt;-outer(x,y,f)</div><div class="line">&gt; contour(x,y,z,col=<span class="string">"blue"</span>)</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_28.png" alt=""></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; contour(x,y,z,col=<span class="string">"blue"</span>)</div><div class="line">&gt; persp(x,y,z,theta=<span class="number">30</span>,phi=<span class="number">30</span>,expand=<span class="number">0.7</span>,col=<span class="string">"lightblue"</span>)</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_29.png" alt=""></p>
<h3 id="地图">地图</h3><p>安装maps包</p>
<p>显示美国地图：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="keyword">library</span>(maps)</div><div class="line">&gt; map(<span class="string">"state"</span>,interior=<span class="literal">F</span>)</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_30.png" alt=""></p>
<blockquote>
<p>state 代表美国</p>
</blockquote>
<p>世界地图的绘制：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; map(<span class="string">"world"</span>,fill=<span class="literal">T</span>,col=heat.colors(<span class="number">10</span>))</div></pre></td></tr></table></figure>
<p><img src="/img/r_02_31.png" alt=""></p>
<h3 id="社交数据可视化">社交数据可视化</h3><p>通过R可以画出如下的facebook社交关系图:</p>
<p><img src="/img/r_02_32.png" alt=""></p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/03/02/线性代数07-直线的参数表示/" itemprop="url">
                线性代数07-直线的参数表示
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2016-03-02T21:44:55+08:00" content="2016-03-02">
            2016-03-02
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/线性代数/" itemprop="url" rel="index">
                  <span itemprop="name">线性代数</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2016/03/02/线性代数07-直线的参数表示/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2016/03/02/线性代数07-直线的参数表示/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h2 id="直线的参数表示">直线的参数表示</h2><p>学习线性代数之前，我们习惯了用$y=kx+b$这种格式来表示平面直角坐标系中的一条直线，这种表示虽然简洁，但并不具有<em>一般性</em>，比如如果想要表示n维平面内的一条直线，就不方便了。</p>
<p>学习了线性代数之后，我们就可以掌握一种通用的表达方式了，这一节来讲解线性代数中，如何通过向量参数来表示n纬平面内的一个直线。</p>
<p><img src="/img/la_07_01.png" alt=""></p>
<p>如图所示，向量$X$为，$<br>\left[<br>\begin{matrix}<br> 2  \\<br> 1  \\<br>\end{matrix}<br>\right]<br>$向量$X$为$<br>\left[<br>\begin{matrix}<br> 1  \\<br> 2  \\<br>\end{matrix}<br>\right]<br>$，那么如果我们想要求与向量$X$平行，且过$(1，2)$点所在的直线，改如何求得呢？</p>
<p>用如下公式计算即可：</p>
<p>$$<br>l=\{Y+tX | t \in R\}<br>$$</p>
<p>例如这个坐标系中的$X$向量和$Y$向量带入公式得：<br>$$<br>\begin{cases}<br>x = 1 + 2t\\<br>y = 2 + t<br>\end{cases}<br>$$</p>
<p>这就是这条直线的参数定义。</p>
<p>这个求直线的参数定义通常被写为如下格式：</p>
<p>$$<br>l=\{X+tV | t \in R\}<br>$$</p>
<p>其中向量$X$和向量$Y$可以是人意维度的向量，这也就具备了一般性。</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/02/29/R语言（01）－R快速入门/" itemprop="url">
                R语言（01）
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2016-02-29T22:08:55+08:00" content="2016-02-29">
            2016-02-29
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/R/" itemprop="url" rel="index">
                  <span itemprop="name">R</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2016/02/29/R语言（01）－R快速入门/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2016/02/29/R语言（01）－R快速入门/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h2 id="What’s_R?">What’s R?</h2><h3 id="R的起源">R的起源</h3><p>R是S语言的一种实现。S语言是由AT&amp;T贝尔实验室开发的一种用来进行数据探索、统计分析、作图的解释型语言。最初S语言的实现版本主要是S-PLUS。S-PLUS是一个商业软件，它基于S语言，并由MathSoft公司的统计科学部进一步完善。后来Auckland大学的Robert Gentleman和Ross Ihaka及其他志愿人员开发了一个R系统。R的使用与S-PLUS有很多类似之处，两个软件有一定的兼容性。</p>
<h3 id="R_is_free">R is free</h3><p>R是用于统计分析、绘图的语言和操作环境。R是属于GNU系统的一个自由、免费、源代码开放的软件，它是一个用于统计计算和统计制图的优秀工具。</p>
<p>R是一套完整的数据处理、计算和制图软件系统。其功能包括：数据存储和处理系统；数组运算工具（其向量、矩阵运算方面功能尤其强大）；完整连贯的统计分析工具；优秀的统计制图功能；简便而强大的编程语言；可操纵数据的输入和输出，可实现分支、循环，用户可自定义功能。</p>
<p>R是一个免费的自由软件，它有UNIX、MacOS和Windows版本，都是可以免费下载和使用的。在R的安装程序中只包含了8个基础模块，其他外在模块可以通过CRAN获得。</p>
<p>官方网站：<a href="http://www.r-project.org" target="_blank" rel="external">http://www.r-project.org</a></p>
<h3 id="R的特点">R的特点</h3><ul>
<li>有效的数据处理和保存机制。</li>
<li>拥有一整套数组和矩阵的操作运算符。</li>
<li>一系列连贯而又完整多数据分析中间工具。</li>
<li>图形统计可以数据直接进行分析和显示，可用于多种图形设备。</li>
<li>一种相当完善、简洁和高效的程序设计语言。它包括条件语句、循环语句、用户自定义的递归函数，以及输入输出接口。</li>
<li>R语言是彻底面向对象的统计编程语言。</li>
<li>R语言和其他编程语言、数据库之间有很好的接口。</li>
<li>R语言是自由软件，可以放心大胆地使用，但其功能却不比任何其它同类软件差。</li>
<li>R语言具有丰富的网上资源。</li>
</ul>
<h2 id="运行R">运行R</h2><h3 id="R的运行界面：">R的运行界面：</h3><p><img src="/img/r_01_01.png" alt="R的运行界面"></p>
<h3 id="安装第三方包">安装第三方包</h3><p><img src="/img/r_01_02.png" alt="安装第三方包"><br><img src="/img/r_01_03.png" alt="安装第三方包"></p>
<p>选择需要安装的包，点击安装即可</p>
<p>安装成功之后可以看到：</p>
<p><img src="/img/r_01_04.png" alt="安装第三方包"></p>
<p><code>假如安装a包需要依赖到b包和c包，那么在安装a包之前，R会自动去安装好所依赖的b包和c包。</code></p>
<h2 id="相关函数介绍">相关函数介绍</h2><p>R能通过手动输入数据，读取文本中的数据，以及orical之类的数据（前提是只要安装好对应的包），基本上所有的数据源都可以读取。</p>
<hr>
<h3 id="基本函数">基本函数</h3><h4 id="c()">c()</h4><p>函数c()是最基本的一个函数，用于创建数列。数列是R中最基本的一个数据结构.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; x=c(<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>)</div><div class="line">&gt; x</div><div class="line">[<span class="number">1</span>] <span class="number">1</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">2</span> <span class="number">4</span> <span class="number">3</span></div></pre></td></tr></table></figure>
<h4 id="mode()">mode()</h4><p>查看数据类型，使用mode( )函数</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; x=c(<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>)</div><div class="line">&gt; mode(x)</div><div class="line">[<span class="number">1</span>] <span class="string">"numeric"</span></div></pre></td></tr></table></figure>
<p>由于上例中x中存放的都是数值类型，所以mode输出”numeric”</p>
<p>如果存放字符类型，则产生”character”的输出：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; y = c(<span class="string">"aaa"</span>,<span class="string">"bbb"</span>,<span class="string">"ccc"</span>)</div><div class="line">&gt; mode(y)</div><div class="line">[<span class="number">1</span>] <span class="string">"character"</span></div></pre></td></tr></table></figure>
<h4 id="length()">length()</h4><p>length( ) 用来看一个向量的长度</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; x = c(<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">2</span>)</div><div class="line">&gt; length(x)</div><div class="line">[<span class="number">1</span>] <span class="number">6</span></div></pre></td></tr></table></figure>
<h4 id="1:100">1:100</h4><p>c(1:100)  相当于 c(1,2,3,4…100)</p>
<h4 id="rbind(x1,x2)和cbind(x1,x2)">rbind(x1,x2)和cbind(x1,x2)</h4><p>rbind(x1,x2) 把两个向量合成一个矩阵，把x1和x2当成两个行来处理</p>
<p>cbind(x1,x2) 同rbind(x1,x2) 不过把x1和x2当成两个列向量来处理</p>
<p><code>这里x1和x2必须长度相等，或者长度为1（如果长度为1，则不足的位置按照唯一的那个元素补齐）</code></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&gt; x1=c(<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>)</div><div class="line">&gt; x2=c(<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>)</div><div class="line">&gt; rbind(x1,x2)</div><div class="line">   [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>] [,<span class="number">4</span>] [,<span class="number">5</span>]</div><div class="line">x1    <span class="number">2</span>    <span class="number">4</span>    <span class="number">6</span>    <span class="number">8</span>    <span class="number">0</span></div><div class="line">x2    <span class="number">1</span>    <span class="number">3</span>    <span class="number">5</span>    <span class="number">7</span>    <span class="number">9</span></div><div class="line">&gt; cbind(x1,x2)</div><div class="line">     x1 x2</div><div class="line">[<span class="number">1</span>,]  <span class="number">2</span>  <span class="number">1</span></div><div class="line">[<span class="number">2</span>,]  <span class="number">4</span>  <span class="number">3</span></div><div class="line">[<span class="number">3</span>,]  <span class="number">6</span>  <span class="number">5</span></div><div class="line">[<span class="number">4</span>,]  <span class="number">8</span>  <span class="number">7</span></div><div class="line">[<span class="number">5</span>,]  <span class="number">0</span>  <span class="number">9</span></div></pre></td></tr></table></figure>
<hr>
<h3 id="求平均值，和，连乘，最值，方差，标准差">求平均值，和，连乘，最值，方差，标准差</h3><h4 id="mean()">mean()</h4><ul>
<li>mean() 传入数列，求平均值</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; x=c(<span class="number">1</span>:<span class="number">100</span>)</div><div class="line">&gt; mean(x)</div><div class="line">[<span class="number">1</span>] <span class="number">50.5</span></div></pre></td></tr></table></figure>
<h4 id="sum()">sum()</h4><ul>
<li>sum() 传入数列，求和</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; sum(x)</div><div class="line">[<span class="number">1</span>] <span class="number">5050</span></div></pre></td></tr></table></figure>
<h4 id="max()">max()</h4><ul>
<li>max() 传入数列，求最大值</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; max(x)</div><div class="line">[<span class="number">1</span>] <span class="number">100</span></div></pre></td></tr></table></figure>
<h4 id="min()">min()</h4><ul>
<li>min() 传入数列，求最小值</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; min(x)</div><div class="line">[<span class="number">1</span>] <span class="number">1</span></div></pre></td></tr></table></figure>
<h4 id="var()">var()</h4><ul>
<li>var() 传入数列，求方差（每一项减去平均值之后再平方，然后把平方和加起来 的值就是方差，方差的大小反应的是数据的离散程度，方差越大，离散程度越大）</li>
</ul>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="selector-tag">var</span>(<span class="selector-tag">x</span>)</div><div class="line"><span class="selector-attr">[1]</span> 841<span class="selector-class">.6667</span></div></pre></td></tr></table></figure>
<h4 id="prod()">prod()</h4><ul>
<li>prod() 传入数列，求连乘</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; prod(x)</div><div class="line">[<span class="number">1</span>] <span class="number">9.332622e+157</span></div></pre></td></tr></table></figure>
<h4 id="sd()">sd()</h4><ul>
<li>sd() 传入数列，求标准差（标准差也是反应离散程度，和求方差略有不同，自行学习）</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; sd(x)</div><div class="line">[<span class="number">1</span>] <span class="number">29.01149</span></div></pre></td></tr></table></figure>
<hr>
<h3 id="help()">help()</h3><p>help() 传入命令名称，查看帮助文档</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">help(mode)</div></pre></td></tr></table></figure>
<p>会打开一个文档页面：</p>
<p><img src="/img/r_01_05.png" alt="文档页面"></p>
<p><code>可以看到里面有个“&lt;-”的符号，这个符号在R中等同于”=&quot;，代表赋值符号。</code></p>
<hr>
<h3 id="向量的操作">向量的操作</h3><h4 id="产生向量">产生向量</h4><p>产生1到10的数字向量</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="number">1</span>:<span class="number">10</span></div><div class="line"> [<span class="number">1</span>]  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span></div></pre></td></tr></table></figure>
<p>产生1到10的数字向量，并且每一项-1</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="number">1</span>:<span class="number">10</span>-<span class="number">1</span></div><div class="line"> [<span class="number">1</span>] <span class="number">0</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span></div></pre></td></tr></table></figure>
<p>产生1到10的数字向量，并且每一项*2</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="number">1</span>:<span class="number">10</span>*<span class="number">2</span></div><div class="line"> [<span class="number">1</span>]  <span class="number">2</span>  <span class="number">4</span>  <span class="number">6</span>  <span class="number">8</span> <span class="number">10</span> <span class="number">12</span> <span class="number">14</span> <span class="number">16</span> <span class="number">18</span> <span class="number">20</span></div></pre></td></tr></table></figure>
<p>产生2到60的数字向量，并且每一项*2+1</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="number">2</span>:<span class="number">60</span>*<span class="number">2</span>+<span class="number">1</span></div><div class="line"> [<span class="number">1</span>]   <span class="number">5</span>   <span class="number">7</span>   <span class="number">9</span>  <span class="number">11</span>  <span class="number">13</span>  <span class="number">15</span>  <span class="number">17</span>  <span class="number">19</span>  <span class="number">21</span>  <span class="number">23</span>  <span class="number">25</span>  <span class="number">27</span>  <span class="number">29</span>  <span class="number">31</span>  <span class="number">33</span>  <span class="number">35</span>  <span class="number">37</span>  <span class="number">39</span></div><div class="line">[<span class="number">19</span>]  <span class="number">41</span>  <span class="number">43</span>  <span class="number">45</span>  <span class="number">47</span>  <span class="number">49</span>  <span class="number">51</span>  <span class="number">53</span>  <span class="number">55</span>  <span class="number">57</span>  <span class="number">59</span>  <span class="number">61</span>  <span class="number">63</span>  <span class="number">65</span>  <span class="number">67</span>  <span class="number">69</span>  <span class="number">71</span>  <span class="number">73</span>  <span class="number">75</span></div><div class="line">[<span class="number">37</span>]  <span class="number">77</span>  <span class="number">79</span>  <span class="number">81</span>  <span class="number">83</span>  <span class="number">85</span>  <span class="number">87</span>  <span class="number">89</span>  <span class="number">91</span>  <span class="number">93</span>  <span class="number">95</span>  <span class="number">97</span>  <span class="number">99</span> <span class="number">101</span> <span class="number">103</span> <span class="number">105</span> <span class="number">107</span> <span class="number">109</span> <span class="number">111</span></div><div class="line">[<span class="number">55</span>] <span class="number">113</span> <span class="number">115</span> <span class="number">117</span> <span class="number">119</span> <span class="number">121</span></div></pre></td></tr></table></figure>
<h4 id="取出向量的元素">取出向量的元素</h4><p>a[5] 代表取出第5个元素</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; a = <span class="number">2</span>:<span class="number">60</span>*<span class="number">2</span>+<span class="number">1</span></div><div class="line">&gt; a</div><div class="line"> [<span class="number">1</span>]   <span class="number">5</span>   <span class="number">7</span>   <span class="number">9</span>  <span class="number">11</span>  <span class="number">13</span>  <span class="number">15</span>  <span class="number">17</span>  <span class="number">19</span>  <span class="number">21</span>  <span class="number">23</span>  <span class="number">25</span>  <span class="number">27</span>  <span class="number">29</span>  <span class="number">31</span>  <span class="number">33</span>  <span class="number">35</span>  <span class="number">37</span>  <span class="number">39</span>  <span class="number">41</span></div><div class="line">[<span class="number">20</span>]  <span class="number">43</span>  <span class="number">45</span>  <span class="number">47</span>  <span class="number">49</span>  <span class="number">51</span>  <span class="number">53</span>  <span class="number">55</span>  <span class="number">57</span>  <span class="number">59</span>  <span class="number">61</span>  <span class="number">63</span>  <span class="number">65</span>  <span class="number">67</span>  <span class="number">69</span>  <span class="number">71</span>  <span class="number">73</span>  <span class="number">75</span>  <span class="number">77</span>  <span class="number">79</span></div><div class="line">[<span class="number">39</span>]  <span class="number">81</span>  <span class="number">83</span>  <span class="number">85</span>  <span class="number">87</span>  <span class="number">89</span>  <span class="number">91</span>  <span class="number">93</span>  <span class="number">95</span>  <span class="number">97</span>  <span class="number">99</span> <span class="number">101</span> <span class="number">103</span> <span class="number">105</span> <span class="number">107</span> <span class="number">109</span> <span class="number">111</span> <span class="number">113</span> <span class="number">115</span> <span class="number">117</span></div><div class="line">[<span class="number">58</span>] <span class="number">119</span> <span class="number">121</span></div><div class="line">&gt; a[<span class="number">5</span>]</div><div class="line">[<span class="number">1</span>] <span class="number">13</span></div></pre></td></tr></table></figure>
<p>取出a中的第1到5个元素</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; a[<span class="number">1</span>:<span class="number">5</span>]</div><div class="line">[<span class="number">1</span>]  <span class="number">5</span>  <span class="number">7</span>  <span class="number">9</span> <span class="number">11</span> <span class="number">13</span></div></pre></td></tr></table></figure>
<p>代表a中第1到5个元素不显示，其他的显示出来。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt; a[-(<span class="number">1</span>:<span class="number">5</span>)]</div><div class="line"> [<span class="number">1</span>]  <span class="number">15</span>  <span class="number">17</span>  <span class="number">19</span>  <span class="number">21</span>  <span class="number">23</span>  <span class="number">25</span>  <span class="number">27</span>  <span class="number">29</span>  <span class="number">31</span>  <span class="number">33</span>  <span class="number">35</span>  <span class="number">37</span>  <span class="number">39</span>  <span class="number">41</span>  <span class="number">43</span>  <span class="number">45</span>  <span class="number">47</span>  <span class="number">49</span>  <span class="number">51</span></div><div class="line">[<span class="number">20</span>]  <span class="number">53</span>  <span class="number">55</span>  <span class="number">57</span>  <span class="number">59</span>  <span class="number">61</span>  <span class="number">63</span>  <span class="number">65</span>  <span class="number">67</span>  <span class="number">69</span>  <span class="number">71</span>  <span class="number">73</span>  <span class="number">75</span>  <span class="number">77</span>  <span class="number">79</span>  <span class="number">81</span>  <span class="number">83</span>  <span class="number">85</span>  <span class="number">87</span>  <span class="number">89</span></div><div class="line">[<span class="number">39</span>]  <span class="number">91</span>  <span class="number">93</span>  <span class="number">95</span>  <span class="number">97</span>  <span class="number">99</span> <span class="number">101</span> <span class="number">103</span> <span class="number">105</span> <span class="number">107</span> <span class="number">109</span> <span class="number">111</span> <span class="number">113</span> <span class="number">115</span> <span class="number">117</span> <span class="number">119</span> <span class="number">121</span></div></pre></td></tr></table></figure>
<p>向量中传入一个数列，代表取出这个数列对应的a中的元素，即取出a中第2，4，7的元素。</p>
<p><code>注意：这里一定要用c()函数</code></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; a[c(<span class="number">2</span>,<span class="number">4</span>,<span class="number">7</span>)]</div><div class="line">[<span class="number">1</span>]  <span class="number">7</span> <span class="number">11</span> <span class="number">17</span></div></pre></td></tr></table></figure>
<p>把元素值小于20的全部列出来</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; a[a&lt;<span class="number">20</span>]</div><div class="line">[<span class="number">1</span>]  <span class="number">5</span>  <span class="number">7</span>  <span class="number">9</span> <span class="number">11</span> <span class="number">13</span> <span class="number">15</span> <span class="number">17</span> <span class="number">19</span></div></pre></td></tr></table></figure>
<p>取出元素大于30并且小于50的元素</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; a[a&gt;<span class="number">30</span> &amp; a&lt;<span class="number">50</span>]</div><div class="line"> [<span class="number">1</span>] <span class="number">31</span> <span class="number">33</span> <span class="number">35</span> <span class="number">37</span> <span class="number">39</span> <span class="number">41</span> <span class="number">43</span> <span class="number">45</span> <span class="number">47</span> <span class="number">49</span></div></pre></td></tr></table></figure>
<p>取出a向量下标为3的元素对应的数值，作为下标的元素。这里a[3]是9，即取出a[9]对应的元素21.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; a[a[<span class="number">3</span>]]</div><div class="line">[<span class="number">1</span>] <span class="number">21</span></div></pre></td></tr></table></figure>
<h3 id="通过_seq()_函数来产生向量">通过 seq() 函数来产生向量</h3><p>产生从5到20，并且公差为1的向量</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; seq(<span class="number">5</span>,<span class="number">20</span>)</div><div class="line"> [<span class="number">1</span>]  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span> <span class="number">15</span> <span class="number">16</span> <span class="number">17</span> <span class="number">18</span> <span class="number">19</span> <span class="number">20</span></div></pre></td></tr></table></figure>
<p>产生从5到121，公差为2的向量</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; seq(<span class="number">5</span>,<span class="number">121</span>,by=<span class="number">2</span>)</div><div class="line"> [<span class="number">1</span>]   <span class="number">5</span>   <span class="number">7</span>   <span class="number">9</span>  <span class="number">11</span>  <span class="number">13</span>  <span class="number">15</span>  <span class="number">17</span>  <span class="number">19</span>  <span class="number">21</span>  <span class="number">23</span>  <span class="number">25</span>  <span class="number">27</span>  <span class="number">29</span>  <span class="number">31</span>  <span class="number">33</span>  <span class="number">35</span>  <span class="number">37</span>  <span class="number">39</span>  <span class="number">41</span></div><div class="line">[<span class="number">20</span>]  <span class="number">43</span>  <span class="number">45</span>  <span class="number">47</span>  <span class="number">49</span>  <span class="number">51</span>  <span class="number">53</span>  <span class="number">55</span>  <span class="number">57</span>  <span class="number">59</span>  <span class="number">61</span>  <span class="number">63</span>  <span class="number">65</span>  <span class="number">67</span>  <span class="number">69</span>  <span class="number">71</span>  <span class="number">73</span>  <span class="number">75</span>  <span class="number">77</span>  <span class="number">79</span></div><div class="line">[<span class="number">39</span>]  <span class="number">81</span>  <span class="number">83</span>  <span class="number">85</span>  <span class="number">87</span>  <span class="number">89</span>  <span class="number">91</span>  <span class="number">93</span>  <span class="number">95</span>  <span class="number">97</span>  <span class="number">99</span> <span class="number">101</span> <span class="number">103</span> <span class="number">105</span> <span class="number">107</span> <span class="number">109</span> <span class="number">111</span> <span class="number">113</span> <span class="number">115</span> <span class="number">117</span></div><div class="line">[<span class="number">58</span>] <span class="number">119</span> <span class="number">121</span></div></pre></td></tr></table></figure>
<p>给出从5到121的，长度为10的等差数列。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; seq(<span class="number">5</span>,<span class="number">121</span>,length=<span class="number">10</span>)</div><div class="line"> [<span class="number">1</span>]   <span class="number">5.00000</span>  <span class="number">17.88889</span>  <span class="number">30.77778</span>  <span class="number">43.66667</span>  <span class="number">56.55556</span>  <span class="number">69.44444</span>  <span class="number">82.33333</span></div><div class="line"> [<span class="number">8</span>]  <span class="number">95.22222</span> <span class="number">108.11111</span> <span class="number">121.00000</span></div></pre></td></tr></table></figure>
<h3 id="常量letters">常量letters</h3><p>产生字母序列letters，这是一个常数向量，包含26个字母。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; letters[<span class="number">1</span>:<span class="number">30</span>]</div><div class="line"> [<span class="number">1</span>] <span class="string">"a"</span> <span class="string">"b"</span> <span class="string">"c"</span> <span class="string">"d"</span> <span class="string">"e"</span> <span class="string">"f"</span> <span class="string">"g"</span> <span class="string">"h"</span> <span class="string">"i"</span> <span class="string">"j"</span> <span class="string">"k"</span> <span class="string">"l"</span> <span class="string">"m"</span> <span class="string">"n"</span> <span class="string">"o"</span> <span class="string">"p"</span> <span class="string">"q"</span> <span class="string">"r"</span> <span class="string">"s"</span></div><div class="line">[<span class="number">20</span>] <span class="string">"t"</span> <span class="string">"u"</span> <span class="string">"v"</span> <span class="string">"w"</span> <span class="string">"x"</span> <span class="string">"y"</span> <span class="string">"z"</span> <span class="literal">NA</span>  <span class="literal">NA</span>  <span class="literal">NA</span>  <span class="literal">NA</span></div></pre></td></tr></table></figure>
<h3 id="which()函数">which()函数</h3><p>which.max()函数给出数列中最大元素对应的下标值</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt; a=c(<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">3</span>)</div><div class="line">&gt; which.max(a)</div><div class="line">[<span class="number">1</span>] <span class="number">11</span></div></pre></td></tr></table></figure>
<p>which.min()函数给出数列中最小元素对应的下标值</p>
<p><code>(如果最大值，最小值有多个，默认只显示下标号最小的那个下标)</code></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; which.min(a)</div><div class="line">[<span class="number">1</span>] <span class="number">6</span></div></pre></td></tr></table></figure>
<p>取出a中最大元素的值</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; a[which.max(a)]</div><div class="line">[<span class="number">1</span>] <span class="number">8</span></div></pre></td></tr></table></figure>
<p>取出元素值为2的下标</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; which(a==<span class="number">2</span>)</div><div class="line">[<span class="number">1</span>] <span class="number">1</span> <span class="number">4</span> <span class="number">9</span></div></pre></td></tr></table></figure>
<p>取出元素值大于5的下标</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; which(a&gt;<span class="number">5</span>)</div><div class="line">[<span class="number">1</span>]  <span class="number">7</span> <span class="number">11</span> <span class="number">13</span></div></pre></td></tr></table></figure>
<h3 id="rev()_向量翻转">rev() 向量翻转</h3><p>rev()函数可以将向量翻转,但不改变原向量</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; a＝<span class="number">1</span>:<span class="number">20</span></div><div class="line">&gt; a</div><div class="line"> [<span class="number">1</span>] <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">2</span> <span class="number">5</span> <span class="number">1</span> <span class="number">6</span> <span class="number">3</span> <span class="number">2</span> <span class="number">5</span> <span class="number">8</span> <span class="number">5</span> <span class="number">7</span> <span class="number">3</span></div><div class="line">&gt; rev(a)</div><div class="line"> [<span class="number">1</span>] <span class="number">3</span> <span class="number">7</span> <span class="number">5</span> <span class="number">8</span> <span class="number">5</span> <span class="number">2</span> <span class="number">3</span> <span class="number">6</span> <span class="number">1</span> <span class="number">5</span> <span class="number">2</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span></div></pre></td></tr></table></figure>
<h3 id="sort()_排序">sort() 排序</h3><p>sort()函数，可以将向量按照从小到大的顺序排序，同样，也不改变原来的向量</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; a=c(<span class="number">5</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">6</span>)</div><div class="line">&gt; a</div><div class="line">[<span class="number">1</span>] <span class="number">5</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">4</span> <span class="number">6</span></div><div class="line">&gt; rev(sort(a))</div><div class="line">[<span class="number">1</span>] <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></div></pre></td></tr></table></figure>
<hr>
<h3 id="矩阵操作">矩阵操作</h3><h4 id="matrix()函数_生成矩阵">matrix()函数 生成矩阵</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&gt; a1=c(<span class="number">1</span>:<span class="number">12</span>)</div><div class="line">&gt; matrix(a1,nrow=<span class="number">3</span>,ncol=<span class="number">4</span>)</div><div class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>] [,<span class="number">4</span>]</div><div class="line">[<span class="number">1</span>,]    <span class="number">1</span>    <span class="number">4</span>    <span class="number">7</span>   <span class="number">10</span></div><div class="line">[<span class="number">2</span>,]    <span class="number">2</span>    <span class="number">5</span>    <span class="number">8</span>   <span class="number">11</span></div><div class="line">[<span class="number">3</span>,]    <span class="number">3</span>    <span class="number">6</span>    <span class="number">9</span>   <span class="number">12</span></div><div class="line">&gt; matrix(a1,nrow=<span class="number">4</span>,ncol=<span class="number">3</span>)</div><div class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>]</div><div class="line">[<span class="number">1</span>,]    <span class="number">1</span>    <span class="number">5</span>    <span class="number">9</span></div><div class="line">[<span class="number">2</span>,]    <span class="number">2</span>    <span class="number">6</span>   <span class="number">10</span></div><div class="line">[<span class="number">3</span>,]    <span class="number">3</span>    <span class="number">7</span>   <span class="number">11</span></div><div class="line">[<span class="number">4</span>,]    <span class="number">4</span>    <span class="number">8</span>   <span class="number">12</span></div><div class="line">&gt; matrix(a1,nrow=<span class="number">4</span>,ncol=<span class="number">3</span>,byrow=<span class="literal">T</span>)</div><div class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>]</div><div class="line">[<span class="number">1</span>,]    <span class="number">1</span>    <span class="number">2</span>    <span class="number">3</span></div><div class="line">[<span class="number">2</span>,]    <span class="number">4</span>    <span class="number">5</span>    <span class="number">6</span></div><div class="line">[<span class="number">3</span>,]    <span class="number">7</span>    <span class="number">8</span>    <span class="number">9</span></div><div class="line">[<span class="number">4</span>,]   <span class="number">10</span>   <span class="number">11</span>   <span class="number">12</span></div></pre></td></tr></table></figure>
<p>如果向量长度大于等于创建矩阵所需要的元素个数，则可以创建矩阵，否则不行：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; matrix(a1,nrow=<span class="number">3</span>,ncol=<span class="number">3</span>)</div><div class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>]</div><div class="line">[<span class="number">1</span>,]    <span class="number">1</span>    <span class="number">4</span>    <span class="number">7</span></div><div class="line">[<span class="number">2</span>,]    <span class="number">2</span>    <span class="number">5</span>    <span class="number">8</span></div><div class="line">[<span class="number">3</span>,]    <span class="number">3</span>    <span class="number">6</span>    <span class="number">9</span></div><div class="line">&gt; matrix(a1,nrow=<span class="number">3</span>,ncol=<span class="number">5</span>)</div><div class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>] [,<span class="number">4</span>] [,<span class="number">5</span>]</div><div class="line">[<span class="number">1</span>,]    <span class="number">1</span>    <span class="number">4</span>    <span class="number">7</span>   <span class="number">10</span>    <span class="number">1</span></div><div class="line">[<span class="number">2</span>,]    <span class="number">2</span>    <span class="number">5</span>    <span class="number">8</span>   <span class="number">11</span>    <span class="number">2</span></div><div class="line">[<span class="number">3</span>,]    <span class="number">3</span>    <span class="number">6</span>    <span class="number">9</span>   <span class="number">12</span>    <span class="number">3</span></div><div class="line">警告信息：</div><div class="line">In matrix(a1, nrow = <span class="number">3</span>, ncol = <span class="number">5</span>) : 数据长度[<span class="number">12</span>]不是矩阵列数[<span class="number">5</span>]的整倍数</div></pre></td></tr></table></figure>
<h4 id="t()">t()</h4><p>t()函数，求矩阵的转置</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; a=matrix(a1,nrow=<span class="number">3</span>,ncol=<span class="number">4</span>)</div><div class="line">&gt; a</div><div class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>] [,<span class="number">4</span>]</div><div class="line">[<span class="number">1</span>,]    <span class="number">1</span>    <span class="number">4</span>    <span class="number">7</span>   <span class="number">10</span></div><div class="line">[<span class="number">2</span>,]    <span class="number">2</span>    <span class="number">5</span>    <span class="number">8</span>   <span class="number">11</span></div><div class="line">[<span class="number">3</span>,]    <span class="number">3</span>    <span class="number">6</span>    <span class="number">9</span>   <span class="number">12</span></div><div class="line">&gt; t(a)</div><div class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>]</div><div class="line">[<span class="number">1</span>,]    <span class="number">1</span>    <span class="number">2</span>    <span class="number">3</span></div><div class="line">[<span class="number">2</span>,]    <span class="number">4</span>    <span class="number">5</span>    <span class="number">6</span></div><div class="line">[<span class="number">3</span>,]    <span class="number">7</span>    <span class="number">8</span>    <span class="number">9</span></div><div class="line">[<span class="number">4</span>,]   <span class="number">10</span>   <span class="number">11</span>   <span class="number">12</span></div></pre></td></tr></table></figure>
<h4 id="矩阵的运算">矩阵的运算</h4><p>矩阵的加减法：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&gt; a=b=matrix(<span class="number">1</span>:<span class="number">12</span>,nrow=<span class="number">3</span>,ncol=<span class="number">4</span>)</div><div class="line">&gt; a+b</div><div class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>] [,<span class="number">4</span>]</div><div class="line">[<span class="number">1</span>,]    <span class="number">2</span>    <span class="number">8</span>   <span class="number">14</span>   <span class="number">20</span></div><div class="line">[<span class="number">2</span>,]    <span class="number">4</span>   <span class="number">10</span>   <span class="number">16</span>   <span class="number">22</span></div><div class="line">[<span class="number">3</span>,]    <span class="number">6</span>   <span class="number">12</span>   <span class="number">18</span>   <span class="number">24</span></div><div class="line">&gt; a-b</div><div class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>] [,<span class="number">4</span>]</div><div class="line">[<span class="number">1</span>,]    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span></div><div class="line">[<span class="number">2</span>,]    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span></div><div class="line">[<span class="number">3</span>,]    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span></div></pre></td></tr></table></figure>
<p>矩阵相乘:</p>
<p>a%*%b</p>
<p><code>注意不是a*b,如果是a*b的话，只是把对应的元素相乘。</code></p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; a=matrix(<span class="number">1</span>:<span class="number">12</span>,nrow=<span class="number">3</span>,ncol=<span class="number">4</span>)</div><div class="line">&gt; b=matrix(<span class="number">1</span>:<span class="number">12</span>,nrow=<span class="number">4</span>,ncol=<span class="number">3</span>)</div><div class="line">&gt; a%*%b</div><div class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>]</div><div class="line">[<span class="number">1</span>,]   <span class="number">70</span>  <span class="number">158</span>  <span class="number">246</span></div><div class="line">[<span class="number">2</span>,]   <span class="number">80</span>  <span class="number">184</span>  <span class="number">288</span></div><div class="line">[<span class="number">3</span>,]   <span class="number">90</span>  <span class="number">210</span>  <span class="number">330</span></div></pre></td></tr></table></figure>
<h4 id="diag()函数，求对角线">diag()函数，求对角线</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&gt; a=matrix(<span class="number">1</span>:<span class="number">16</span>,nrow=<span class="number">4</span>,ncol=<span class="number">4</span>)</div><div class="line">&gt; a</div><div class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>] [,<span class="number">4</span>]</div><div class="line">[<span class="number">1</span>,]    <span class="number">1</span>    <span class="number">5</span>    <span class="number">9</span>   <span class="number">13</span></div><div class="line">[<span class="number">2</span>,]    <span class="number">2</span>    <span class="number">6</span>   <span class="number">10</span>   <span class="number">14</span></div><div class="line">[<span class="number">3</span>,]    <span class="number">3</span>    <span class="number">7</span>   <span class="number">11</span>   <span class="number">15</span></div><div class="line">[<span class="number">4</span>,]    <span class="number">4</span>    <span class="number">8</span>   <span class="number">12</span>   <span class="number">16</span></div><div class="line">&gt; diag(a)</div><div class="line">[<span class="number">1</span>]  <span class="number">1</span>  <span class="number">6</span> <span class="number">11</span> <span class="number">16</span></div><div class="line">&gt; diag(diag(a))</div><div class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>] [,<span class="number">4</span>]</div><div class="line">[<span class="number">1</span>,]    <span class="number">1</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span></div><div class="line">[<span class="number">2</span>,]    <span class="number">0</span>    <span class="number">6</span>    <span class="number">0</span>    <span class="number">0</span></div><div class="line">[<span class="number">3</span>,]    <span class="number">0</span>    <span class="number">0</span>   <span class="number">11</span>    <span class="number">0</span></div><div class="line">[<span class="number">4</span>,]    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>   <span class="number">16</span></div></pre></td></tr></table></figure>
<p>得到一个行列数为4的对角线为1的单位矩阵：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; diag(<span class="number">4</span>)</div><div class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>] [,<span class="number">4</span>]</div><div class="line">[<span class="number">1</span>,]    <span class="number">1</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span></div><div class="line">[<span class="number">2</span>,]    <span class="number">0</span>    <span class="number">1</span>    <span class="number">0</span>    <span class="number">0</span></div><div class="line">[<span class="number">3</span>,]    <span class="number">0</span>    <span class="number">0</span>    <span class="number">1</span>    <span class="number">0</span></div><div class="line">[<span class="number">4</span>,]    <span class="number">0</span>    <span class="number">0</span>    <span class="number">0</span>    <span class="number">1</span></div></pre></td></tr></table></figure>
<h4 id="rnorm()">rnorm()</h4><p>rnorm()函数，按照正态分布，取出若干个随机数</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; a=matrix(rnorm(<span class="number">16</span>),<span class="number">4</span>,<span class="number">4</span>)</div><div class="line">&gt; a</div><div class="line">          [,<span class="number">1</span>]         [,<span class="number">2</span>]       [,<span class="number">3</span>]       [,<span class="number">4</span>]</div><div class="line">[<span class="number">1</span>,]  <span class="number">1.691672</span>  <span class="number">0.154788749</span>  <span class="number">0.7834991</span> -<span class="number">1.8964252</span></div><div class="line">[<span class="number">2</span>,]  <span class="number">1.388345</span>  <span class="number">0.922029319</span> -<span class="number">0.2400506</span>  <span class="number">0.1874301</span></div><div class="line">[<span class="number">3</span>,] -<span class="number">1.823898</span> -<span class="number">0.005734707</span> -<span class="number">1.3519814</span>  <span class="number">0.9270790</span></div><div class="line">[<span class="number">4</span>,] -<span class="number">0.267829</span>  <span class="number">0.763870795</span>  <span class="number">0.6594918</span>  <span class="number">0.9205407</span></div></pre></td></tr></table></figure>
<h4 id="solve()">solve()</h4><p>solve()函数，求逆矩阵</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; solve(a)</div><div class="line">            [,<span class="number">1</span>]       [,<span class="number">2</span>]       [,<span class="number">3</span>]       [,<span class="number">4</span>]</div><div class="line">[<span class="number">1</span>,] -<span class="number">0.44792192</span>  <span class="number">0.4452669</span> -<span class="number">0.5585795</span> -<span class="number">0.4508867</span></div><div class="line">[<span class="number">2</span>,]  <span class="number">0.85187912</span>  <span class="number">0.2515954</span>  <span class="number">0.8583943</span>  <span class="number">0.8392558</span></div><div class="line">[<span class="number">3</span>,]  <span class="number">0.01781248</span> -<span class="number">0.4399525</span> -<span class="number">0.3953840</span>  <span class="number">0.5244663</span></div><div class="line">[<span class="number">4</span>,] -<span class="number">0.84997791</span>  <span class="number">0.2359636</span> -<span class="number">0.5915584</span> -<span class="number">0.1170234</span></div></pre></td></tr></table></figure>
<p>通过solve()函数解方程组：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&gt; a=matrix(rnorm(<span class="number">16</span>),<span class="number">4</span>,<span class="number">4</span>)</div><div class="line">&gt; a</div><div class="line">            [,<span class="number">1</span>]        [,<span class="number">2</span>]       [,<span class="number">3</span>]       [,<span class="number">4</span>]</div><div class="line">[<span class="number">1</span>,] -<span class="number">0.73318587</span>  <span class="number">1.87980710</span>  <span class="number">0.4991373</span> -<span class="number">0.1038004</span></div><div class="line">[<span class="number">2</span>,]  <span class="number">0.13700903</span> -<span class="number">0.19411509</span>  <span class="number">0.5412432</span> -<span class="number">0.8160280</span></div><div class="line">[<span class="number">3</span>,] -<span class="number">0.07649991</span>  <span class="number">0.01615857</span> -<span class="number">0.4907614</span> -<span class="number">2.3282147</span></div><div class="line">[<span class="number">4</span>,] -<span class="number">0.34977245</span>  <span class="number">0.25837835</span> -<span class="number">0.6195753</span>  <span class="number">0.1512799</span></div><div class="line">&gt; b=c(<span class="number">1</span>:<span class="number">4</span>)</div><div class="line">&gt; b</div><div class="line">[<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></div><div class="line">&gt; solve(a,b)</div><div class="line">[<span class="number">1</span>] -<span class="number">29.246248</span> -<span class="number">12.182426</span>   <span class="number">4.634966</span>  -<span class="number">1.389123</span></div></pre></td></tr></table></figure>
<p>相当于在解这样一个方程组：</p>
<p>-0.73318587 <em> x1 + 1.87980710 </em> x2 + 0.4991373 <em> x3 -0.1038004 </em> x4 = 1</p>
<p>0.13700903 <em> x1 - 0.19411509 </em> x2 + 0.5412432 <em> x3 -0.8160280 </em> x4 = 1</p>
<p>-0.07649991 <em> x1 + 0.01615857 </em> x2 - 0.4907614 <em> x3 -2.3282147 </em> x4 = 1</p>
<p>-0.34977245 <em> x1 + 0.25837835 </em> x2 - 0.6195753 <em> x3 + 0.1512799 </em> x4 = 1</p>
<p>最终解为：</p>
<p>x1= -29.246248</p>
<p>x2= -12.182426</p>
<p>x3= 4.634966</p>
<p>x4= -1.389123</p>
<h4 id="eigen()">eigen()</h4><p>eigen()求矩阵的特征值函数</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&gt; a=diag(<span class="number">4</span>)+<span class="number">1</span></div><div class="line">&gt; a</div><div class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>] [,<span class="number">4</span>]</div><div class="line">[<span class="number">1</span>,]    <span class="number">2</span>    <span class="number">1</span>    <span class="number">1</span>    <span class="number">1</span></div><div class="line">[<span class="number">2</span>,]    <span class="number">1</span>    <span class="number">2</span>    <span class="number">1</span>    <span class="number">1</span></div><div class="line">[<span class="number">3</span>,]    <span class="number">1</span>    <span class="number">1</span>    <span class="number">2</span>    <span class="number">1</span></div><div class="line">[<span class="number">4</span>,]    <span class="number">1</span>    <span class="number">1</span>    <span class="number">1</span>    <span class="number">2</span></div><div class="line">&gt; a.e=eigen(a,symmetric=<span class="literal">T</span>)</div><div class="line">&gt; a.e</div><div class="line">$values</div><div class="line">[<span class="number">1</span>] <span class="number">5</span> <span class="number">1</span> <span class="number">1</span> <span class="number">1</span></div><div class="line"></div><div class="line">$vectors</div><div class="line">     [,<span class="number">1</span>]       [,<span class="number">2</span>]       [,<span class="number">3</span>]       [,<span class="number">4</span>]</div><div class="line">[<span class="number">1</span>,] -<span class="number">0.5</span>  <span class="number">0.8660254</span>  <span class="number">0.0000000</span>  <span class="number">0.0000000</span></div><div class="line">[<span class="number">2</span>,] -<span class="number">0.5</span> -<span class="number">0.2886751</span> -<span class="number">0.5773503</span> -<span class="number">0.5773503</span></div><div class="line">[<span class="number">3</span>,] -<span class="number">0.5</span> -<span class="number">0.2886751</span> -<span class="number">0.2113249</span>  <span class="number">0.7886751</span></div><div class="line">[<span class="number">4</span>,] -<span class="number">0.5</span> -<span class="number">0.2886751</span>  <span class="number">0.7886751</span> -<span class="number">0.2113249</span></div><div class="line">&gt; a.e$vectors%*%diag(a.e$values)%*%t(a.e$vectors)</div><div class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>] [,<span class="number">4</span>]</div><div class="line">[<span class="number">1</span>,]    <span class="number">2</span>    <span class="number">1</span>    <span class="number">1</span>    <span class="number">1</span></div><div class="line">[<span class="number">2</span>,]    <span class="number">1</span>    <span class="number">2</span>    <span class="number">1</span>    <span class="number">1</span></div><div class="line">[<span class="number">3</span>,]    <span class="number">1</span>    <span class="number">1</span>    <span class="number">2</span>    <span class="number">1</span></div><div class="line">[<span class="number">4</span>,]    <span class="number">1</span>    <span class="number">1</span>    <span class="number">1</span>    <span class="number">2</span></div></pre></td></tr></table></figure>
<h3 id="数组">数组</h3><p>数组  相当于加了纬度的向量</p>
<p>向量不是数组，矩阵是数组的一种特殊情况</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&gt; x=c(<span class="number">1</span>:<span class="number">6</span>)</div><div class="line">&gt; x</div><div class="line">[<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span></div><div class="line">&gt; is.vector(x)</div><div class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></div><div class="line">&gt; is.array(x)</div><div class="line">[<span class="number">1</span>] <span class="literal">FALSE</span></div><div class="line">&gt; dim(x)&lt;-c(<span class="number">2</span>,<span class="number">3</span>)</div><div class="line">&gt; x</div><div class="line">     [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>]</div><div class="line">[<span class="number">1</span>,]    <span class="number">1</span>    <span class="number">3</span>    <span class="number">5</span></div><div class="line">[<span class="number">2</span>,]    <span class="number">2</span>    <span class="number">4</span>    <span class="number">6</span></div><div class="line">&gt; is.array(x)</div><div class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></div><div class="line">&gt; is.matrix(x)</div><div class="line">[<span class="number">1</span>] <span class="literal">TRUE</span></div></pre></td></tr></table></figure>
<h3 id="数据框">数据框</h3><p>形式类似矩阵，但不同的地方是矩阵必须元素都是数字，而数据框每一列可以是不同类型的数据（可以某一列是数字，某一列是字符）。</p>
<p>一般情况，每列是一个变量，每行是一个观测值。</p>
<p>data.frame(x1,x2) 将两个等长的向量组合成一个数据框，(一定要是等长的向量才可以组合)</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&gt; x1=c(<span class="number">10</span>,<span class="number">13</span>,<span class="number">45</span>,<span class="number">26</span>,<span class="number">23</span>)</div><div class="line">&gt; x2=c(<span class="number">22</span>,<span class="number">33</span>,<span class="number">44</span>,<span class="number">55</span>,<span class="number">66</span>)</div><div class="line">&gt; x=data.frame(x1,x2)</div><div class="line">&gt; x</div><div class="line">  x1 x2</div><div class="line"><span class="number">1</span> <span class="number">10</span> <span class="number">22</span></div><div class="line"><span class="number">2</span> <span class="number">13</span> <span class="number">33</span></div><div class="line"><span class="number">3</span> <span class="number">45</span> <span class="number">44</span></div><div class="line"><span class="number">4</span> <span class="number">26</span> <span class="number">55</span></div><div class="line"><span class="number">5</span> <span class="number">23</span> <span class="number">66</span></div></pre></td></tr></table></figure>
<p>也可以制定表头</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; x=data.frame(<span class="string">'重量'</span>=x1,<span class="string">'运费'</span>=x2)</div><div class="line">&gt; x</div><div class="line">  重量 运费</div><div class="line"><span class="number">1</span>   <span class="number">10</span>   <span class="number">22</span></div><div class="line"><span class="number">2</span>   <span class="number">13</span>   <span class="number">33</span></div><div class="line"><span class="number">3</span>   <span class="number">45</span>   <span class="number">44</span></div><div class="line"><span class="number">4</span>   <span class="number">26</span>   <span class="number">55</span></div><div class="line"><span class="number">5</span>   <span class="number">23</span>   <span class="number">66</span></div></pre></td></tr></table></figure>
<p>plot()函数绘制散点图：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&gt; plot(x)</div></pre></td></tr></table></figure>
<p><img src="/img/r_01_06.png" alt="plot散点图"></p>
<hr>
<h3 id="从外部读取数据">从外部读取数据</h3><p>先设置工作目录，把文本文件放于该目录下</p>
<p>首先工作目录下有一个”abc.txt”的文件：</p>
<p><img src="/img/r_01_07.png" alt="外部文件abc.txt"></p>
<p>在R中通过read.table()函数 读取外部文件中的数据：</p>
<p><img src="/img/r_01_08.png" alt="读取外部文件"></p>
<p>文本或excel的数据均可通过剪切板操作,”clipboard”是一个常量字符串，代表剪切板。</p>
<p><img src="/img/r_01_09.png" alt="读取粘贴板上的数据"></p>
<h4 id="读取excel文件数据">读取excel文件数据</h4><p><strong>方法1:</strong>先把excel另存为空格分割的prn文本格式（以空格来分隔数据）再读</p>
<p><img src="/img/r_01_10.png" alt="读取prn文件"></p>
<p>或者可以另存为csv格式（以逗号来分隔数据），然后调用read.csv(“test.csv”,header=T)来读取。</p>
<p><strong>方法2:</strong>安装RODBC包，再通过ODBC读</p>
<p><img src="/img/r_01_11.png" alt="通过ODBC读取csv"></p>
<h3 id="循环语句">循环语句</h3><h4 id="for">for</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="keyword">for</span>(i <span class="keyword">in</span> <span class="number">1</span>:<span class="number">59</span>)&#123;a[i]=i*<span class="number">2</span>+<span class="number">3</span>&#125;</div><div class="line">&gt; a</div><div class="line"> [<span class="number">1</span>]   <span class="number">5</span>   <span class="number">7</span>   <span class="number">9</span>  <span class="number">11</span>  <span class="number">13</span>  <span class="number">15</span>  <span class="number">17</span>  <span class="number">19</span>  <span class="number">21</span>  <span class="number">23</span>  <span class="number">25</span>  <span class="number">27</span>  <span class="number">29</span>  <span class="number">31</span>  <span class="number">33</span>  <span class="number">35</span>  <span class="number">37</span>  <span class="number">39</span>  <span class="number">41</span></div><div class="line">[<span class="number">20</span>]  <span class="number">43</span>  <span class="number">45</span>  <span class="number">47</span>  <span class="number">49</span>  <span class="number">51</span>  <span class="number">53</span>  <span class="number">55</span>  <span class="number">57</span>  <span class="number">59</span>  <span class="number">61</span>  <span class="number">63</span>  <span class="number">65</span>  <span class="number">67</span>  <span class="number">69</span>  <span class="number">71</span>  <span class="number">73</span>  <span class="number">75</span>  <span class="number">77</span>  <span class="number">79</span></div><div class="line">[<span class="number">39</span>]  <span class="number">81</span>  <span class="number">83</span>  <span class="number">85</span>  <span class="number">87</span>  <span class="number">89</span>  <span class="number">91</span>  <span class="number">93</span>  <span class="number">95</span>  <span class="number">97</span>  <span class="number">99</span> <span class="number">101</span> <span class="number">103</span> <span class="number">105</span> <span class="number">107</span> <span class="number">109</span> <span class="number">111</span> <span class="number">113</span> <span class="number">115</span> <span class="number">117</span></div><div class="line">[<span class="number">58</span>] <span class="number">119</span> <span class="number">121</span></div></pre></td></tr></table></figure>
<h4 id="while">while</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; a[<span class="number">1</span>]=<span class="number">5</span></div><div class="line">&gt; i=<span class="number">1</span></div><div class="line">&gt; <span class="keyword">while</span>(a[i]&lt;<span class="number">121</span>)&#123;i=i+<span class="number">1</span>;a[i]=a[i-<span class="number">1</span>]+<span class="number">2</span>&#125;</div><div class="line">&gt; a</div><div class="line"> [<span class="number">1</span>]   <span class="number">5</span>   <span class="number">7</span>   <span class="number">9</span>  <span class="number">11</span>  <span class="number">13</span>  <span class="number">15</span>  <span class="number">17</span>  <span class="number">19</span>  <span class="number">21</span>  <span class="number">23</span>  <span class="number">25</span>  <span class="number">27</span>  <span class="number">29</span>  <span class="number">31</span>  <span class="number">33</span>  <span class="number">35</span>  <span class="number">37</span>  <span class="number">39</span>  <span class="number">41</span></div><div class="line">[<span class="number">20</span>]  <span class="number">43</span>  <span class="number">45</span>  <span class="number">47</span>  <span class="number">49</span>  <span class="number">51</span>  <span class="number">53</span>  <span class="number">55</span>  <span class="number">57</span>  <span class="number">59</span>  <span class="number">61</span>  <span class="number">63</span>  <span class="number">65</span>  <span class="number">67</span>  <span class="number">69</span>  <span class="number">71</span>  <span class="number">73</span>  <span class="number">75</span>  <span class="number">77</span>  <span class="number">79</span></div><div class="line">[<span class="number">39</span>]  <span class="number">81</span>  <span class="number">83</span>  <span class="number">85</span>  <span class="number">87</span>  <span class="number">89</span>  <span class="number">91</span>  <span class="number">93</span>  <span class="number">95</span>  <span class="number">97</span>  <span class="number">99</span> <span class="number">101</span> <span class="number">103</span> <span class="number">105</span> <span class="number">107</span> <span class="number">109</span> <span class="number">111</span> <span class="number">113</span> <span class="number">115</span> <span class="number">117</span></div><div class="line">[<span class="number">58</span>] <span class="number">119</span> <span class="number">121</span></div></pre></td></tr></table></figure>
<h3 id="执行外部脚本">执行外部脚本</h3><h4 id="source()_print()">source() print()</h4><p>R语言出了在控制台中执行之外，也可以写成外部脚本。</p>
<p><img src="/img/r_01_12.png" alt="外部脚本"></p>
<p>脚本中的内容：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">a = <span class="number">1</span>:<span class="number">10</span></div><div class="line">print(a)</div></pre></td></tr></table></figure>
<p>写入脚本中的输出，必须使用print()函数才能打印出来。</p>
<p>通过source()函数可以执行脚本文件：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; <span class="keyword">source</span>(<span class="string">"h.r"</span>)</div><div class="line"> [<span class="number">1</span>]  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span></div></pre></td></tr></table></figure>
<hr>
<h3 id="分布函数">分布函数</h3><h4 id="正态分布函数_rnorm()">正态分布函数 rnorm()</h4><p>产生100个正态分布的随机数，平均值是80，标准差是7:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; rnorm(<span class="number">100</span>,mean=<span class="number">80</span>,sd=<span class="number">7</span>)</div><div class="line">  [<span class="number">1</span>] <span class="number">91.84170</span> <span class="number">89.71842</span> <span class="number">67.23271</span> <span class="number">78.12520</span> <span class="number">81.08352</span> <span class="number">86.45421</span> <span class="number">79.95986</span> <span class="number">85.34710</span></div><div class="line">  [<span class="number">9</span>] <span class="number">85.48449</span> <span class="number">78.31965</span> <span class="number">70.53613</span> <span class="number">84.61644</span> <span class="number">66.72502</span> <span class="number">81.31201</span> <span class="number">86.48955</span> <span class="number">86.44378</span></div><div class="line"> [<span class="number">17</span>] <span class="number">74.86770</span> <span class="number">80.95906</span> <span class="number">79.46450</span> <span class="number">77.55159</span> <span class="number">93.15865</span> <span class="number">78.64119</span> <span class="number">80.11311</span> <span class="number">81.80865</span></div><div class="line"> [<span class="number">25</span>] <span class="number">83.49396</span> <span class="number">83.78870</span> <span class="number">76.56467</span> <span class="number">75.66297</span> <span class="number">79.27340</span> <span class="number">74.28780</span> <span class="number">63.70250</span> <span class="number">81.05896</span></div><div class="line"> [<span class="number">33</span>] <span class="number">86.11023</span> <span class="number">84.20057</span> <span class="number">73.15261</span> <span class="number">81.13779</span> <span class="number">89.98181</span> <span class="number">71.93431</span> <span class="number">70.49228</span> <span class="number">77.61948</span></div><div class="line"> [<span class="number">41</span>] <span class="number">79.40982</span> <span class="number">78.53584</span> <span class="number">71.21602</span> <span class="number">73.33143</span> <span class="number">92.46275</span> <span class="number">75.92289</span> <span class="number">75.94395</span> <span class="number">75.28812</span></div><div class="line"> [<span class="number">49</span>] <span class="number">74.10398</span> <span class="number">79.39188</span> <span class="number">73.27445</span> <span class="number">95.29717</span> <span class="number">84.59038</span> <span class="number">81.25490</span> <span class="number">87.83171</span> <span class="number">62.59891</span></div><div class="line"> [<span class="number">57</span>] <span class="number">78.97906</span> <span class="number">91.78480</span> <span class="number">90.82124</span> <span class="number">83.91811</span> <span class="number">77.69758</span> <span class="number">78.35002</span> <span class="number">81.41204</span> <span class="number">78.43336</span></div><div class="line"> [<span class="number">65</span>] <span class="number">78.50897</span> <span class="number">83.49485</span> <span class="number">86.27006</span> <span class="number">75.10600</span> <span class="number">73.42888</span> <span class="number">79.37818</span> <span class="number">82.71879</span> <span class="number">82.94783</span></div><div class="line"> [<span class="number">73</span>] <span class="number">63.24346</span> <span class="number">82.08028</span> <span class="number">77.65782</span> <span class="number">81.06058</span> <span class="number">62.43572</span> <span class="number">79.50682</span> <span class="number">87.96813</span> <span class="number">70.42317</span></div><div class="line"> [<span class="number">81</span>] <span class="number">78.87907</span> <span class="number">72.35188</span> <span class="number">76.39345</span> <span class="number">69.57194</span> <span class="number">77.76283</span> <span class="number">88.07266</span> <span class="number">68.14906</span> <span class="number">60.45371</span></div><div class="line"> [<span class="number">89</span>] <span class="number">80.58541</span> <span class="number">80.46402</span> <span class="number">89.73413</span> <span class="number">82.27584</span> <span class="number">85.80826</span> <span class="number">80.18303</span> <span class="number">93.81132</span> <span class="number">83.20696</span></div><div class="line"> [<span class="number">97</span>] <span class="number">85.48223</span> <span class="number">99.15548</span> <span class="number">80.25896</span> <span class="number">83.88441</span></div></pre></td></tr></table></figure>
<h4 id="泊松分布函数rpois()">泊松分布函数rpois()</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt; rpois(<span class="number">100</span>,<span class="number">1</span>:<span class="number">9</span>)</div><div class="line">  [<span class="number">1</span>]  <span class="number">2</span>  <span class="number">1</span>  <span class="number">5</span>  <span class="number">7</span>  <span class="number">3</span>  <span class="number">5</span>  <span class="number">9</span>  <span class="number">5</span>  <span class="number">7</span>  <span class="number">1</span>  <span class="number">3</span>  <span class="number">2</span>  <span class="number">2</span>  <span class="number">5</span>  <span class="number">8</span> <span class="number">12</span>  <span class="number">8</span> <span class="number">10</span>  <span class="number">2</span>  <span class="number">5</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">5</span>  <span class="number">8</span></div><div class="line"> [<span class="number">26</span>]  <span class="number">8</span>  <span class="number">5</span>  <span class="number">0</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">4</span>  <span class="number">6</span> <span class="number">12</span>  <span class="number">8</span>  <span class="number">4</span> <span class="number">10</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">4</span>  <span class="number">3</span>  <span class="number">6</span>  <span class="number">8</span>  <span class="number">6</span>  <span class="number">0</span>  <span class="number">0</span>  <span class="number">5</span>  <span class="number">4</span>  <span class="number">4</span></div><div class="line"> [<span class="number">51</span>]  <span class="number">5</span>  <span class="number">3</span> <span class="number">12</span> <span class="number">11</span>  <span class="number">2</span>  <span class="number">4</span>  <span class="number">1</span>  <span class="number">3</span>  <span class="number">8</span>  <span class="number">2</span>  <span class="number">5</span>  <span class="number">8</span>  <span class="number">5</span>  <span class="number">4</span>  <span class="number">4</span>  <span class="number">3</span>  <span class="number">5</span>  <span class="number">5</span> <span class="number">11</span>  <span class="number">6</span> <span class="number">10</span>  <span class="number">9</span>  <span class="number">1</span>  <span class="number">1</span>  <span class="number">3</span></div><div class="line"> [<span class="number">76</span>]  <span class="number">5</span>  <span class="number">8</span>  <span class="number">4</span>  <span class="number">9</span> <span class="number">11</span>  <span class="number">5</span>  <span class="number">0</span>  <span class="number">4</span>  <span class="number">2</span>  <span class="number">5</span>  <span class="number">6</span> <span class="number">10</span>  <span class="number">9</span> <span class="number">12</span>  <span class="number">7</span>  <span class="number">0</span>  <span class="number">2</span>  <span class="number">4</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">2</span> <span class="number">10</span> <span class="number">11</span> <span class="number">13</span>  <span class="number">1</span></div></pre></td></tr></table></figure>
<h4 id="指数分布函数rexp()">指数分布函数rexp()</h4><h4 id="gamma分布函数rgamma()">gamma分布函数rgamma()</h4><h4 id="均匀分布函数runif()">均匀分布函数runif()</h4><p>产生100个均匀分布的80到100的随机数</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; runif(<span class="number">100</span>,min=<span class="number">80</span>,max=<span class="number">100</span>)</div><div class="line">  [<span class="number">1</span>] <span class="number">82.32568</span> <span class="number">82.02504</span> <span class="number">94.93998</span> <span class="number">97.56770</span> <span class="number">88.23401</span> <span class="number">88.74055</span> <span class="number">98.43785</span> <span class="number">94.25619</span></div><div class="line">  [<span class="number">9</span>] <span class="number">81.32116</span> <span class="number">84.68563</span> <span class="number">94.29525</span> <span class="number">92.97103</span> <span class="number">82.97045</span> <span class="number">99.32680</span> <span class="number">94.50783</span> <span class="number">96.61253</span></div><div class="line"> [<span class="number">17</span>] <span class="number">98.53980</span> <span class="number">95.93528</span> <span class="number">92.12032</span> <span class="number">92.76401</span> <span class="number">85.38213</span> <span class="number">84.43117</span> <span class="number">96.86250</span> <span class="number">84.69108</span></div><div class="line"> [<span class="number">25</span>] <span class="number">91.17830</span> <span class="number">82.79405</span> <span class="number">94.58394</span> <span class="number">84.90274</span> <span class="number">84.07085</span> <span class="number">83.87202</span> <span class="number">82.59535</span> <span class="number">88.50601</span></div><div class="line"> [<span class="number">33</span>] <span class="number">83.38860</span> <span class="number">81.65984</span> <span class="number">95.71859</span> <span class="number">83.73108</span> <span class="number">88.13112</span> <span class="number">90.18066</span> <span class="number">96.21735</span> <span class="number">89.05043</span></div><div class="line"> [<span class="number">41</span>] <span class="number">88.48573</span> <span class="number">96.24177</span> <span class="number">89.48188</span> <span class="number">85.85154</span> <span class="number">83.67180</span> <span class="number">84.38839</span> <span class="number">85.30037</span> <span class="number">93.55860</span></div><div class="line"> [<span class="number">49</span>] <span class="number">81.74515</span> <span class="number">86.87908</span> <span class="number">89.86651</span> <span class="number">83.78685</span> <span class="number">96.95712</span> <span class="number">92.91492</span> <span class="number">80.78897</span> <span class="number">87.21055</span></div><div class="line"> [<span class="number">57</span>] <span class="number">86.64808</span> <span class="number">80.24332</span> <span class="number">98.48211</span> <span class="number">91.42558</span> <span class="number">99.35341</span> <span class="number">81.53274</span> <span class="number">84.49945</span> <span class="number">80.28354</span></div><div class="line"> [<span class="number">65</span>] <span class="number">89.47206</span> <span class="number">81.66101</span> <span class="number">85.38194</span> <span class="number">81.64460</span> <span class="number">98.43649</span> <span class="number">84.28751</span> <span class="number">85.85431</span> <span class="number">84.08602</span></div><div class="line"> [<span class="number">73</span>] <span class="number">82.29368</span> <span class="number">95.23472</span> <span class="number">84.10213</span> <span class="number">89.61257</span> <span class="number">90.84469</span> <span class="number">94.17226</span> <span class="number">98.69019</span> <span class="number">87.96953</span></div><div class="line"> [<span class="number">81</span>] <span class="number">91.89866</span> <span class="number">92.23568</span> <span class="number">94.01739</span> <span class="number">91.93723</span> <span class="number">93.71547</span> <span class="number">88.28105</span> <span class="number">88.27131</span> <span class="number">88.09687</span></div><div class="line"> [<span class="number">89</span>] <span class="number">94.74121</span> <span class="number">86.47239</span> <span class="number">85.55283</span> <span class="number">94.90056</span> <span class="number">93.91155</span> <span class="number">86.16455</span> <span class="number">84.53169</span> <span class="number">97.29593</span></div><div class="line"> [<span class="number">97</span>] <span class="number">93.21098</span> <span class="number">94.80586</span> <span class="number">80.71853</span> <span class="number">91.62332</span></div></pre></td></tr></table></figure>
<h4 id="二项分布函数rbinom()">二项分布函数rbinom()</h4><h4 id="几何分布函数rgeom()">几何分布函数rgeom()</h4><hr>
<h3 id="四舍五入_round()">四舍五入 round()</h3><p>产生100个正态分布的随机数，平均值是80，标准差是7，对取出的元素进行四舍五入处理:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; round(rnorm(<span class="number">100</span>,mean=<span class="number">80</span>,sd=<span class="number">7</span>))</div><div class="line">  [<span class="number">1</span>]  <span class="number">79</span>  <span class="number">75</span>  <span class="number">93</span>  <span class="number">96</span>  <span class="number">82</span>  <span class="number">70</span>  <span class="number">83</span>  <span class="number">77</span>  <span class="number">78</span>  <span class="number">84</span>  <span class="number">79</span>  <span class="number">80</span>  <span class="number">78</span>  <span class="number">81</span>  <span class="number">77</span>  <span class="number">67</span>  <span class="number">73</span>  <span class="number">76</span></div><div class="line"> [<span class="number">19</span>]  <span class="number">86</span>  <span class="number">76</span>  <span class="number">80</span>  <span class="number">84</span>  <span class="number">83</span>  <span class="number">88</span>  <span class="number">73</span>  <span class="number">86</span>  <span class="number">79</span>  <span class="number">80</span>  <span class="number">89</span>  <span class="number">88</span>  <span class="number">63</span>  <span class="number">79</span>  <span class="number">82</span>  <span class="number">78</span>  <span class="number">82</span>  <span class="number">75</span></div><div class="line"> [<span class="number">37</span>]  <span class="number">81</span>  <span class="number">87</span>  <span class="number">89</span>  <span class="number">89</span>  <span class="number">79</span>  <span class="number">76</span>  <span class="number">81</span>  <span class="number">93</span>  <span class="number">75</span>  <span class="number">73</span>  <span class="number">77</span>  <span class="number">74</span>  <span class="number">71</span>  <span class="number">83</span>  <span class="number">69</span>  <span class="number">77</span>  <span class="number">88</span>  <span class="number">74</span></div><div class="line"> [<span class="number">55</span>]  <span class="number">78</span>  <span class="number">75</span>  <span class="number">79</span>  <span class="number">71</span>  <span class="number">87</span>  <span class="number">91</span>  <span class="number">87</span>  <span class="number">71</span>  <span class="number">84</span>  <span class="number">74</span>  <span class="number">76</span>  <span class="number">90</span> <span class="number">102</span>  <span class="number">75</span>  <span class="number">78</span>  <span class="number">91</span>  <span class="number">84</span>  <span class="number">87</span></div><div class="line"> [<span class="number">73</span>]  <span class="number">71</span>  <span class="number">78</span>  <span class="number">75</span>  <span class="number">83</span>  <span class="number">76</span>  <span class="number">78</span>  <span class="number">80</span>  <span class="number">78</span>  <span class="number">83</span>  <span class="number">79</span>  <span class="number">92</span>  <span class="number">90</span>  <span class="number">92</span>  <span class="number">78</span>  <span class="number">74</span>  <span class="number">80</span>  <span class="number">86</span>  <span class="number">82</span></div><div class="line"> [<span class="number">91</span>]  <span class="number">80</span>  <span class="number">79</span>  <span class="number">78</span>  <span class="number">72</span>  <span class="number">69</span>  <span class="number">77</span>  <span class="number">84</span>  <span class="number">80</span>  <span class="number">94</span>  <span class="number">71</span></div></pre></td></tr></table></figure>
<h2 id="一个综合训练">一个综合训练</h2><p>模拟产生统计专业同学的名单（学号区分），记录数学分析，线性代数，概率统计三科成绩，然后进行一些统计分析。</p>
<p>产生一百个学号：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&gt; num=seq(<span class="number">10378001</span>,<span class="number">10378100</span>)</div><div class="line">&gt; num</div><div class="line">  [<span class="number">1</span>] <span class="number">10378001</span> <span class="number">10378002</span> <span class="number">10378003</span> <span class="number">10378004</span> <span class="number">10378005</span> <span class="number">10378006</span> <span class="number">10378007</span> <span class="number">10378008</span></div><div class="line">  [<span class="number">9</span>] <span class="number">10378009</span> <span class="number">10378010</span> <span class="number">10378011</span> <span class="number">10378012</span> <span class="number">10378013</span> <span class="number">10378014</span> <span class="number">10378015</span> <span class="number">10378016</span></div><div class="line"> [<span class="number">17</span>] <span class="number">10378017</span> <span class="number">10378018</span> <span class="number">10378019</span> <span class="number">10378020</span> <span class="number">10378021</span> <span class="number">10378022</span> <span class="number">10378023</span> <span class="number">10378024</span></div><div class="line"> [<span class="number">25</span>] <span class="number">10378025</span> <span class="number">10378026</span> <span class="number">10378027</span> <span class="number">10378028</span> <span class="number">10378029</span> <span class="number">10378030</span> <span class="number">10378031</span> <span class="number">10378032</span></div><div class="line"> [<span class="number">33</span>] <span class="number">10378033</span> <span class="number">10378034</span> <span class="number">10378035</span> <span class="number">10378036</span> <span class="number">10378037</span> <span class="number">10378038</span> <span class="number">10378039</span> <span class="number">10378040</span></div><div class="line"> [<span class="number">41</span>] <span class="number">10378041</span> <span class="number">10378042</span> <span class="number">10378043</span> <span class="number">10378044</span> <span class="number">10378045</span> <span class="number">10378046</span> <span class="number">10378047</span> <span class="number">10378048</span></div><div class="line"> [<span class="number">49</span>] <span class="number">10378049</span> <span class="number">10378050</span> <span class="number">10378051</span> <span class="number">10378052</span> <span class="number">10378053</span> <span class="number">10378054</span> <span class="number">10378055</span> <span class="number">10378056</span></div><div class="line"> [<span class="number">57</span>] <span class="number">10378057</span> <span class="number">10378058</span> <span class="number">10378059</span> <span class="number">10378060</span> <span class="number">10378061</span> <span class="number">10378062</span> <span class="number">10378063</span> <span class="number">10378064</span></div><div class="line"> [<span class="number">65</span>] <span class="number">10378065</span> <span class="number">10378066</span> <span class="number">10378067</span> <span class="number">10378068</span> <span class="number">10378069</span> <span class="number">10378070</span> <span class="number">10378071</span> <span class="number">10378072</span></div><div class="line"> [<span class="number">73</span>] <span class="number">10378073</span> <span class="number">10378074</span> <span class="number">10378075</span> <span class="number">10378076</span> <span class="number">10378077</span> <span class="number">10378078</span> <span class="number">10378079</span> <span class="number">10378080</span></div><div class="line"> [<span class="number">81</span>] <span class="number">10378081</span> <span class="number">10378082</span> <span class="number">10378083</span> <span class="number">10378084</span> <span class="number">10378085</span> <span class="number">10378086</span> <span class="number">10378087</span> <span class="number">10378088</span></div><div class="line"> [<span class="number">89</span>] <span class="number">10378089</span> <span class="number">10378090</span> <span class="number">10378091</span> <span class="number">10378092</span> <span class="number">10378093</span> <span class="number">10378094</span> <span class="number">10378095</span> <span class="number">10378096</span></div><div class="line"> [<span class="number">97</span>] <span class="number">10378097</span> <span class="number">10378098</span> <span class="number">10378099</span> <span class="number">10378100</span></div></pre></td></tr></table></figure>
<p>产生100个均匀分布的80到100的随机数，round()函数取整数部分进行四舍五入:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&gt; x1=round(runif(<span class="number">100</span>,min=<span class="number">80</span>,max=<span class="number">100</span>))</div><div class="line">&gt; x1</div><div class="line">  [<span class="number">1</span>] <span class="number">100</span> <span class="number">100</span>  <span class="number">81</span>  <span class="number">81</span>  <span class="number">88</span>  <span class="number">88</span>  <span class="number">95</span>  <span class="number">84</span>  <span class="number">93</span>  <span class="number">83</span>  <span class="number">97</span>  <span class="number">87</span>  <span class="number">87</span>  <span class="number">86</span>  <span class="number">98</span>  <span class="number">82</span>  <span class="number">89</span>  <span class="number">82</span></div><div class="line"> [<span class="number">19</span>]  <span class="number">87</span>  <span class="number">82</span>  <span class="number">82</span>  <span class="number">86</span>  <span class="number">90</span>  <span class="number">83</span>  <span class="number">98</span>  <span class="number">91</span>  <span class="number">90</span>  <span class="number">94</span>  <span class="number">94</span>  <span class="number">88</span>  <span class="number">85</span>  <span class="number">92</span>  <span class="number">87</span>  <span class="number">88</span>  <span class="number">88</span>  <span class="number">93</span></div><div class="line"> [<span class="number">37</span>]  <span class="number">86</span>  <span class="number">88</span>  <span class="number">97</span>  <span class="number">92</span>  <span class="number">90</span>  <span class="number">94</span> <span class="number">100</span>  <span class="number">91</span>  <span class="number">87</span>  <span class="number">98</span>  <span class="number">83</span>  <span class="number">92</span>  <span class="number">96</span>  <span class="number">86</span>  <span class="number">90</span>  <span class="number">93</span>  <span class="number">97</span>  <span class="number">95</span></div><div class="line"> [<span class="number">55</span>]  <span class="number">80</span>  <span class="number">89</span>  <span class="number">86</span>  <span class="number">81</span>  <span class="number">98</span>  <span class="number">90</span>  <span class="number">82</span>  <span class="number">90</span>  <span class="number">95</span>  <span class="number">90</span>  <span class="number">87</span>  <span class="number">81</span>  <span class="number">92</span>  <span class="number">88</span>  <span class="number">81</span>  <span class="number">86</span>  <span class="number">88</span>  <span class="number">97</span></div><div class="line"> [<span class="number">73</span>]  <span class="number">93</span>  <span class="number">88</span>  <span class="number">96</span>  <span class="number">85</span>  <span class="number">90</span>  <span class="number">90</span>  <span class="number">91</span>  <span class="number">90</span>  <span class="number">87</span>  <span class="number">91</span>  <span class="number">96</span>  <span class="number">95</span>  <span class="number">94</span>  <span class="number">96</span>  <span class="number">91</span>  <span class="number">90</span>  <span class="number">82</span>  <span class="number">81</span></div><div class="line"> [<span class="number">91</span>]  <span class="number">88</span>  <span class="number">98</span>  <span class="number">89</span> <span class="number">100</span>  <span class="number">92</span>  <span class="number">85</span>  <span class="number">81</span>  <span class="number">82</span> <span class="number">100</span>  <span class="number">83</span></div></pre></td></tr></table></figure>
<p>产生100个随机元素，平均值是80，标准差是7：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; x2=round(rnorm(<span class="number">100</span>,mean=<span class="number">80</span>,sd=<span class="number">7</span>))</div><div class="line">&gt; x2</div><div class="line">  [<span class="number">1</span>] <span class="number">75</span> <span class="number">78</span> <span class="number">81</span> <span class="number">66</span> <span class="number">86</span> <span class="number">80</span> <span class="number">77</span> <span class="number">80</span> <span class="number">79</span> <span class="number">74</span> <span class="number">76</span> <span class="number">82</span> <span class="number">76</span> <span class="number">74</span> <span class="number">77</span> <span class="number">84</span> <span class="number">75</span> <span class="number">77</span> <span class="number">86</span> <span class="number">68</span> <span class="number">88</span> <span class="number">71</span> <span class="number">83</span> <span class="number">83</span> <span class="number">61</span></div><div class="line"> [<span class="number">26</span>] <span class="number">83</span> <span class="number">79</span> <span class="number">93</span> <span class="number">77</span> <span class="number">75</span> <span class="number">78</span> <span class="number">91</span> <span class="number">82</span> <span class="number">73</span> <span class="number">84</span> <span class="number">86</span> <span class="number">80</span> <span class="number">79</span> <span class="number">88</span> <span class="number">79</span> <span class="number">66</span> <span class="number">85</span> <span class="number">75</span> <span class="number">81</span> <span class="number">75</span> <span class="number">69</span> <span class="number">82</span> <span class="number">80</span> <span class="number">84</span> <span class="number">78</span></div><div class="line"> [<span class="number">51</span>] <span class="number">67</span> <span class="number">92</span> <span class="number">97</span> <span class="number">90</span> <span class="number">65</span> <span class="number">77</span> <span class="number">74</span> <span class="number">84</span> <span class="number">82</span> <span class="number">83</span> <span class="number">74</span> <span class="number">86</span> <span class="number">83</span> <span class="number">79</span> <span class="number">80</span> <span class="number">90</span> <span class="number">74</span> <span class="number">81</span> <span class="number">72</span> <span class="number">83</span> <span class="number">79</span> <span class="number">80</span> <span class="number">70</span> <span class="number">71</span> <span class="number">95</span></div><div class="line"> [<span class="number">76</span>] <span class="number">71</span> <span class="number">78</span> <span class="number">87</span> <span class="number">79</span> <span class="number">82</span> <span class="number">75</span> <span class="number">85</span> <span class="number">80</span> <span class="number">78</span> <span class="number">83</span> <span class="number">79</span> <span class="number">77</span> <span class="number">88</span> <span class="number">80</span> <span class="number">77</span> <span class="number">75</span> <span class="number">84</span> <span class="number">84</span> <span class="number">87</span> <span class="number">78</span> <span class="number">77</span> <span class="number">74</span> <span class="number">76</span> <span class="number">86</span> <span class="number">84</span></div></pre></td></tr></table></figure>
<p>产生100个随机元素，平均值是83，标准差是18，由于标准差比较大，所以可能会产生大于100的错误数据，所以要对大于100的数据进行处理，通过which()函数取出大于100的元素下标，设置为100</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&gt; x3=round(rnorm(<span class="number">100</span>,mean=<span class="number">83</span>,sd=<span class="number">18</span>))</div><div class="line">&gt; x3</div><div class="line">  [<span class="number">1</span>]  <span class="number">81</span>  <span class="number">81</span>  <span class="number">74</span>  <span class="number">80</span> <span class="number">102</span>  <span class="number">88</span>  <span class="number">65</span>  <span class="number">80</span>  <span class="number">82</span>  <span class="number">66</span>  <span class="number">70</span>  <span class="number">76</span> <span class="number">102</span>  <span class="number">58</span>  <span class="number">63</span> <span class="number">122</span>  <span class="number">70</span>  <span class="number">71</span></div><div class="line"> [<span class="number">19</span>] <span class="number">103</span>  <span class="number">92</span>  <span class="number">65</span>  <span class="number">66</span>  <span class="number">45</span>  <span class="number">86</span>  <span class="number">98</span>  <span class="number">68</span>  <span class="number">71</span>  <span class="number">73</span>  <span class="number">96</span>  <span class="number">85</span>  <span class="number">86</span> <span class="number">112</span>  <span class="number">58</span>  <span class="number">68</span> <span class="number">111</span>  <span class="number">66</span></div><div class="line"> [<span class="number">37</span>]  <span class="number">90</span> <span class="number">104</span> <span class="number">112</span>  <span class="number">48</span>  <span class="number">94</span>  <span class="number">83</span>  <span class="number">74</span>  <span class="number">81</span>  <span class="number">84</span> <span class="number">120</span>  <span class="number">94</span>  <span class="number">79</span>  <span class="number">79</span>  <span class="number">44</span>  <span class="number">95</span>  <span class="number">71</span>  <span class="number">68</span>  <span class="number">86</span></div><div class="line"> [<span class="number">55</span>]  <span class="number">80</span>  <span class="number">63</span>  <span class="number">73</span>  <span class="number">95</span>  <span class="number">81</span> <span class="number">113</span>  <span class="number">56</span>  <span class="number">64</span> <span class="number">100</span>  <span class="number">68</span> <span class="number">107</span>  <span class="number">74</span> <span class="number">109</span> <span class="number">123</span> <span class="number">102</span>  <span class="number">70</span>  <span class="number">66</span>  <span class="number">75</span></div><div class="line"> [<span class="number">73</span>]  <span class="number">70</span>  <span class="number">48</span>  <span class="number">86</span>  <span class="number">56</span>  <span class="number">74</span>  <span class="number">86</span>  <span class="number">79</span>  <span class="number">75</span>  <span class="number">67</span>  <span class="number">50</span>  <span class="number">68</span>  <span class="number">96</span>  <span class="number">93</span>  <span class="number">60</span> <span class="number">124</span> <span class="number">111</span>  <span class="number">77</span>  <span class="number">82</span></div><div class="line"> [<span class="number">91</span>]  <span class="number">65</span>  <span class="number">93</span> <span class="number">121</span>  <span class="number">69</span>  <span class="number">69</span> <span class="number">106</span>  <span class="number">75</span>  <span class="number">98</span>  <span class="number">99</span>  <span class="number">87</span></div><div class="line">&gt; x3[which(x3&gt;<span class="number">100</span>)]=<span class="number">100</span></div><div class="line">&gt; x3</div><div class="line">  [<span class="number">1</span>]  <span class="number">81</span>  <span class="number">81</span>  <span class="number">74</span>  <span class="number">80</span> <span class="number">100</span>  <span class="number">88</span>  <span class="number">65</span>  <span class="number">80</span>  <span class="number">82</span>  <span class="number">66</span>  <span class="number">70</span>  <span class="number">76</span> <span class="number">100</span>  <span class="number">58</span>  <span class="number">63</span> <span class="number">100</span>  <span class="number">70</span>  <span class="number">71</span></div><div class="line"> [<span class="number">19</span>] <span class="number">100</span>  <span class="number">92</span>  <span class="number">65</span>  <span class="number">66</span>  <span class="number">45</span>  <span class="number">86</span>  <span class="number">98</span>  <span class="number">68</span>  <span class="number">71</span>  <span class="number">73</span>  <span class="number">96</span>  <span class="number">85</span>  <span class="number">86</span> <span class="number">100</span>  <span class="number">58</span>  <span class="number">68</span> <span class="number">100</span>  <span class="number">66</span></div><div class="line"> [<span class="number">37</span>]  <span class="number">90</span> <span class="number">100</span> <span class="number">100</span>  <span class="number">48</span>  <span class="number">94</span>  <span class="number">83</span>  <span class="number">74</span>  <span class="number">81</span>  <span class="number">84</span> <span class="number">100</span>  <span class="number">94</span>  <span class="number">79</span>  <span class="number">79</span>  <span class="number">44</span>  <span class="number">95</span>  <span class="number">71</span>  <span class="number">68</span>  <span class="number">86</span></div><div class="line"> [<span class="number">55</span>]  <span class="number">80</span>  <span class="number">63</span>  <span class="number">73</span>  <span class="number">95</span>  <span class="number">81</span> <span class="number">100</span>  <span class="number">56</span>  <span class="number">64</span> <span class="number">100</span>  <span class="number">68</span> <span class="number">100</span>  <span class="number">74</span> <span class="number">100</span> <span class="number">100</span> <span class="number">100</span>  <span class="number">70</span>  <span class="number">66</span>  <span class="number">75</span></div><div class="line"> [<span class="number">73</span>]  <span class="number">70</span>  <span class="number">48</span>  <span class="number">86</span>  <span class="number">56</span>  <span class="number">74</span>  <span class="number">86</span>  <span class="number">79</span>  <span class="number">75</span>  <span class="number">67</span>  <span class="number">50</span>  <span class="number">68</span>  <span class="number">96</span>  <span class="number">93</span>  <span class="number">60</span> <span class="number">100</span> <span class="number">100</span>  <span class="number">77</span>  <span class="number">82</span></div><div class="line"> [<span class="number">91</span>]  <span class="number">65</span>  <span class="number">93</span> <span class="number">100</span>  <span class="number">69</span>  <span class="number">69</span> <span class="number">100</span>  <span class="number">75</span>  <span class="number">98</span>  <span class="number">99</span>  <span class="number">87</span></div></pre></td></tr></table></figure>
<p>通过data.frame()函数，将数据合成数据框：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&gt; x=data.frame(num,x1,x2,x3)</div><div class="line">&gt; x</div><div class="line">         num  x1 x2  x3</div><div class="line"><span class="number">1</span>   <span class="number">10378001</span> <span class="number">100</span> <span class="number">75</span>  <span class="number">81</span></div><div class="line"><span class="number">2</span>   <span class="number">10378002</span> <span class="number">100</span> <span class="number">78</span>  <span class="number">81</span></div><div class="line"><span class="number">3</span>   <span class="number">10378003</span>  <span class="number">81</span> <span class="number">81</span>  <span class="number">74</span></div><div class="line"><span class="number">4</span>   <span class="number">10378004</span>  <span class="number">81</span> <span class="number">66</span>  <span class="number">80</span></div><div class="line"><span class="number">5</span>   <span class="number">10378005</span>  <span class="number">88</span> <span class="number">86</span> <span class="number">100</span></div><div class="line"><span class="number">6</span>   <span class="number">10378006</span>  <span class="number">88</span> <span class="number">80</span>  <span class="number">88</span></div><div class="line"><span class="number">7</span>   <span class="number">10378007</span>  <span class="number">95</span> <span class="number">77</span>  <span class="number">65</span></div><div class="line"><span class="number">8</span>   <span class="number">10378008</span>  <span class="number">84</span> <span class="number">80</span>  <span class="number">80</span></div><div class="line"><span class="number">9</span>   <span class="number">10378009</span>  <span class="number">93</span> <span class="number">79</span>  <span class="number">82</span></div><div class="line"><span class="number">10</span>  <span class="number">10378010</span>  <span class="number">83</span> <span class="number">74</span>  <span class="number">66</span></div><div class="line"><span class="number">11</span>  <span class="number">10378011</span>  <span class="number">97</span> <span class="number">76</span>  <span class="number">70</span></div><div class="line"><span class="number">12</span>  <span class="number">10378012</span>  <span class="number">87</span> <span class="number">82</span>  <span class="number">76</span></div><div class="line"><span class="number">13</span>  <span class="number">10378013</span>  <span class="number">87</span> <span class="number">76</span> <span class="number">100</span></div><div class="line"><span class="number">14</span>  <span class="number">10378014</span>  <span class="number">86</span> <span class="number">74</span>  <span class="number">58</span></div><div class="line"><span class="keyword">...</span></div></pre></td></tr></table></figure>
<p>通过write.table()函数，将数据保存到硬盘上。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">write.table(x,file=<span class="string">"mark.txt"</span>,col.names=<span class="literal">F</span>,row.names=<span class="literal">F</span>,sep=<span class="string">" "</span>)</div></pre></td></tr></table></figure>
<p><code>(这里也可以写绝对路径。默认路径就是当前工作空间。)</code></p>
<p><img src="/img/r_01_13.png" alt="输出文件"></p>
<hr>
<p>开始分析数据：<br>计算各科平均分：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&gt; mean(x[<span class="number">1</span>])</div><div class="line">[<span class="number">1</span>] <span class="literal">NA</span></div><div class="line">警告信息：</div><div class="line">In mean.default(x[<span class="number">1</span>]) : 参数不是数值也不是逻辑值：回覆<span class="literal">NA</span></div><div class="line">&gt; colMeans(x)</div><div class="line">        num          x1          x2          x3 </div><div class="line"><span class="number">10378050.50</span>       <span class="number">89.59</span>       <span class="number">79.51</span>       <span class="number">79.85</span> </div><div class="line">&gt; colMeans(x)[c(<span class="string">"x1"</span>,<span class="string">"x2"</span>,<span class="string">"x3"</span>)]</div><div class="line">   x1    x2    x3 </div><div class="line"><span class="number">89.59</span> <span class="number">79.51</span> <span class="number">79.85</span> </div><div class="line">&gt; apply(x,<span class="number">2</span>,mean)</div><div class="line">        num          x1          x2          x3 </div><div class="line"><span class="number">10378050.50</span>       <span class="number">89.59</span>       <span class="number">79.51</span>       <span class="number">79.85</span></div></pre></td></tr></table></figure>
<p>cloMeans()对列求平均值</p>
<p>apply(x,2,mean)</p>
<pre><code>第一个参数代表要操作的数据框，
第二个参数如果是<span class="number">1</span>的话代表在行上做操作，如果是<span class="number">2</span>的话，代表在列上做操作
第三个参数代表操作类型，mean是求平均数
</code></pre><p>求各科的最高分，最低分</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&gt; apply(x,<span class="number">2</span>,max)</div><div class="line">     num       x1       x2       x3 </div><div class="line"><span class="number">10378100</span>      <span class="number">100</span>       <span class="number">97</span>      <span class="number">100</span> </div><div class="line">&gt; apply(x,<span class="number">2</span>,min)</div><div class="line">     num       x1       x2       x3 </div><div class="line"><span class="number">10378001</span>       <span class="number">80</span>       <span class="number">61</span>       <span class="number">44</span></div></pre></td></tr></table></figure>
<p>求每个人的总分：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt; apply(x[c(<span class="string">"x1"</span>,<span class="string">"x2"</span>,<span class="string">"x3"</span>)],<span class="number">1</span>,sum)</div><div class="line">  [<span class="number">1</span>] <span class="number">256</span> <span class="number">259</span> <span class="number">236</span> <span class="number">227</span> <span class="number">274</span> <span class="number">256</span> <span class="number">237</span> <span class="number">244</span> <span class="number">254</span> <span class="number">223</span> <span class="number">243</span> <span class="number">245</span> <span class="number">263</span> <span class="number">218</span> <span class="number">238</span> <span class="number">266</span> <span class="number">234</span> <span class="number">230</span></div><div class="line"> [<span class="number">19</span>] <span class="number">273</span> <span class="number">242</span> <span class="number">235</span> <span class="number">223</span> <span class="number">218</span> <span class="number">252</span> <span class="number">257</span> <span class="number">242</span> <span class="number">240</span> <span class="number">260</span> <span class="number">267</span> <span class="number">248</span> <span class="number">249</span> <span class="number">283</span> <span class="number">227</span> <span class="number">229</span> <span class="number">272</span> <span class="number">245</span></div><div class="line"> [<span class="number">37</span>] <span class="number">256</span> <span class="number">267</span> <span class="number">285</span> <span class="number">219</span> <span class="number">250</span> <span class="number">262</span> <span class="number">249</span> <span class="number">253</span> <span class="number">246</span> <span class="number">267</span> <span class="number">259</span> <span class="number">251</span> <span class="number">259</span> <span class="number">208</span> <span class="number">252</span> <span class="number">256</span> <span class="number">262</span> <span class="number">271</span></div><div class="line"> [<span class="number">55</span>] <span class="number">225</span> <span class="number">229</span> <span class="number">233</span> <span class="number">260</span> <span class="number">261</span> <span class="number">273</span> <span class="number">212</span> <span class="number">240</span> <span class="number">278</span> <span class="number">237</span> <span class="number">267</span> <span class="number">245</span> <span class="number">266</span> <span class="number">269</span> <span class="number">253</span> <span class="number">239</span> <span class="number">233</span> <span class="number">252</span></div><div class="line"> [<span class="number">73</span>] <span class="number">233</span> <span class="number">207</span> <span class="number">277</span> <span class="number">212</span> <span class="number">242</span> <span class="number">263</span> <span class="number">249</span> <span class="number">247</span> <span class="number">229</span> <span class="number">226</span> <span class="number">244</span> <span class="number">269</span> <span class="number">270</span> <span class="number">235</span> <span class="number">268</span> <span class="number">278</span> <span class="number">239</span> <span class="number">240</span></div><div class="line"> [<span class="number">91</span>] <span class="number">228</span> <span class="number">275</span> <span class="number">273</span> <span class="number">256</span> <span class="number">239</span> <span class="number">262</span> <span class="number">230</span> <span class="number">256</span> <span class="number">285</span> <span class="number">254</span></div></pre></td></tr></table></figure></span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/01/12/HelloDjango!/" itemprop="url">
                HelloDjango!--Django开发极速入门
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2016-01-12T17:26:55+08:00" content="2016-01-12">
            2016-01-12
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/django/" itemprop="url" rel="index">
                  <span itemprop="name">django</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2016/01/12/HelloDjango!/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2016/01/12/HelloDjango!/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h2 id="About_Django">About Django</h2><blockquote>
<p><strong><a href="https://www.djangoproject.com/" target="_blank" rel="external">Django</a></strong>是一个开源的python web应用框架，最初是被开发来用于管理劳伦斯出版集团旗下的一些以新闻内容为主的网站，即是CMS（内容管理系统）软件。于2005年7月在BSD许可证下发布。</p>
<p>截至目前，Django的最新版本是1.9.1。Django的名字来源于上世纪五十年代的一位吉普赛吉他手的名字Django Reinhardt，其中‘d’是不发音的，为此django官方还录制了一个<a href="http://red-bean.com/~adrian/django_pronunciation.mp3" target="_blank" rel="external">音频</a>来更正大家的读音。</p>
</blockquote>
<h3 id="Django的理念">Django的理念</h3><p>django是一个高级的python web框架，鼓励开发人员快速开发出<strong>干净务实</strong>的设计。由于是由有经验的web开发者创建的，所以它避免了很多web开发的麻烦。</p>
<p>可以使得开发人员更加专注的写应用程序而不需要重新造轮子。而且django是免费开源的。</p>
<p><strong>三个特点：</strong></p>
<ul>
<li>快速：帮助开发人员快速将想法变成现实</li>
<li>安全：可以帮助开发人员避免很多常见的安全方面的问题</li>
<li>可伸缩性：一些很复杂繁琐的web项目也可以由django来构建</li>
</ul>
<h3 id="都有谁用过Django呢？">都有谁用过Django呢？</h3><p>Disqus, Instagram, Pinterest以及Mozilla 都已经使用Django很多年了，而且Django目前已经可以承受每秒最高5万的访问量。</p>
<h2 id="环境配置">环境配置</h2><p>在配置好python2.7运行环境之后，执行：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip install Django==<span class="number">1.9</span><span class="number">.1</span></div></pre></td></tr></table></figure>
<p>即可自动下载并安装Django，如果提示权限不足，可以尝试<code>sudo pip install Django==1.9.1</code>。</p>
<p>如果选择通过<a href="https://www.djangoproject.com/download/1.9.1/tarball/" target="_blank" rel="external">下载zip包</a>安装，下载成功后，解压zip包，命令行进入到Django-1.9.1目录下，执行：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python setup<span class="selector-class">.py</span> install</div></pre></td></tr></table></figure>
<h2 id="创建第一个django项目">创建第一个django项目</h2><p>命令行执行：</p>
<figure class="highlight nsis"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">django-<span class="literal">admin</span> startproject mysite</div></pre></td></tr></table></figure>
<p>创建mysite项目，<code>cd</code> 进入到mysite，我们可以看到生成了如下几个文件：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mysite/</div><div class="line">    manage<span class="selector-class">.py</span>			＃这是一个与django交互的命令行工具</div><div class="line">    mysite/</div><div class="line">        __init__<span class="selector-class">.py</span></div><div class="line">        settings<span class="selector-class">.py</span>		＃配置设置</div><div class="line">        urls<span class="selector-class">.py</span>			＃声明一系列django用来处理分发的url</div><div class="line">        wsgi<span class="selector-class">.py</span>			＃PythonWeb服务器网关接口，相当于一种协议，使得python的web应用可以部署到所有遵循这个协议点服务器上。用于部署django项目的</div></pre></td></tr></table></figure>
<p>在这里，我们执行</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage<span class="selector-class">.py</span> startapp polls</div></pre></td></tr></table></figure>
<p>来创建一个名叫polls的app。</p>
<p>我们会发现，在mysite下会多产生一个polls的目录，这个目录的结构如下：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">polls/</div><div class="line">    __init__<span class="selector-class">.py</span></div><div class="line">    admin<span class="selector-class">.py</span></div><div class="line">    apps<span class="selector-class">.py</span></div><div class="line">    migrations/</div><div class="line">        __init__<span class="selector-class">.py</span></div><div class="line">    models<span class="selector-class">.py</span> 		#定义moudle</div><div class="line">    tests<span class="selector-class">.py</span></div><div class="line">    views<span class="selector-class">.py</span> 		＃定义view</div></pre></td></tr></table></figure>
<h3 id="配置url，让我们的项目run起来">配置url，让我们的项目run起来</h3><p>django通过urls.py文件作为路由文件，将获取到的url通过正则匹配去分发到各个app下的urls.py，然后再由app内的urls.py通过正则匹配分发到各个view层中，并执行相关方法。</p>
<p>这里我们分别配置我们主项目和子项目中的urls.py文件：</p>
<p>mysite/urls.py:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> include</div><div class="line">	url(<span class="string">r'^polls/'</span>, include(<span class="string">'polls.urls'</span>)),</div></pre></td></tr></table></figure>
<p>polls/urls.py:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url</div><div class="line"></div><div class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</div><div class="line"></div><div class="line">urlpatterns = [</div><div class="line">    url(<span class="string">r'^$'</span>, views.index, name=<span class="string">'index'</span>),</div><div class="line">]</div></pre></td></tr></table></figure>
<p>可以看到子项目中的url指向了views中的index方法，那么我们把views的index进行完善：</p>
<p>polls/views.py:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request)</span>:</span></div><div class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">"Hello Django"</span>)</div></pre></td></tr></table></figure>
<p>这个时候我们在命令行中输入：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage<span class="selector-class">.py</span> runserver</div></pre></td></tr></table></figure>
<p>把项目跑起来之后，在浏览器输入：<a href="http://localhost:8000/polls/" target="_blank" rel="external">http://localhost:8000/polls/</a> 就可以看到以下输出结果了。</p>
<p><img src="/img/django_01_01.png" alt="Hello Django"></p>
<h3 id="定义models，创建数据库">定义models，创建数据库</h3><p>django遵循DRY原则（Don’t repeat yourself），其实道理很简单，避免数据冗余，它认为冗余的就是坏的。<br>所以django中定义的每一个model，都应该是单一的，明确的，包含了所有必要信息的。<br>这样做的目的就是，你在一处定义好model，在任何其他的地方，就可以通过这个model来获取到由他派生出的信息。</p>
<p>修改models.py:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</div><div class="line"><span class="keyword">from</span> django.utils <span class="keyword">import</span> timezone</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Question</span><span class="params">(models.Model)</span>:</span></div><div class="line">    question_text = models.CharField(max_length=<span class="number">200</span>)</div><div class="line">    pub_date = models.DateTimeField(<span class="string">'date published'</span>)</div><div class="line"></div><div class="line">	<span class="comment">#当前model的字符串表示</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.question_text</div><div class="line"></div><div class="line">	<span class="comment">#判断这条Question是否是当天发出的</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">was_published_recently</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.pub_date &gt;= timezone.now() - datetime.timedelta(days=<span class="number">1</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Choice</span><span class="params">(models.Model)</span>:</span></div><div class="line">    question = models.ForeignKey(Question, on_delete=models.CASCADE)</div><div class="line">    choice_text = models.CharField(max_length=<span class="number">200</span>)</div><div class="line">    votes = models.IntegerField(default=<span class="number">0</span>)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.choice_text</div></pre></td></tr></table></figure>
<p>mysite下的settings.py:</p>
<p>的INSTALLED_APPS中加入：</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">'polls.apps.PollsConfig'</span>,</div></pre></td></tr></table></figure>
<p>现在，我们可以执行<code>python manage.py makemigrations</code>,这条命令会去遍历所有在settings.py中INSTALLED_APPS下配置的app，如果发现对应app的models文件有改动，就会在这个app下的<code>migrations</code>目录下生成一个数据库的scheme文件，这里我们可以看到生成了一个<code>0001_initial.py</code>文件，这个文件描述了model对应的数据库操作，这个文件是可编辑的。</p>
<p>我们还可以通过执行<code>python manage.py sqlmigrate polls 0001</code>命令，查看上面那个scheme文件所对应的SQL语句。</p>
<p>这个时候，其实我们的sql语句并没有执行，数据库也并没有创建，我们需要执行下面这条语句，来让我们的scheme文件生效：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage<span class="selector-class">.py</span> migrate</div></pre></td></tr></table></figure>
<p>这下，我们的表就创建成功了。</p>
<p>看似繁琐的操作，其实我们只要记住三步走的套路，就很容易掌握：</p>
<ul>
<li>1.修改models.py文件</li>
<li>2.执行python manage.py makemigrations</li>
<li>3.执行python manage.py migrate</li>
</ul>
<p>这里我有一个疑问，就是2，3的操作明明可以一步执行完，为什么还需要分成两条命令呢？</p>
<p>这里官方的解释是：</p>
<blockquote>
<p>The reason that there are separate commands to make and apply migrations is because you’ll commit migrations to your version control system and ship them with your app; they not only make your development easier, they’re also useable by other developers and in production.</p>
</blockquote>
<p>我表示依然不理解。</p>
<h3 id="通过django的shell来插入数据">通过django的shell来插入数据</h3><p>django 给我们提供了一个shell，通过执行<code>python manage.py shell</code>进入。</p>
<p>下面通过这个shell来插入一些数据，也顺便体验一下django的orm数据库操作。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;</span>&gt; from polls.models import Question, Choice </div><div class="line"><span class="meta">&gt;&gt;</span>&gt; from django.utils import timezone</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; Question.objects.all()</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; []</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; q = Question(question_text=<span class="string">"What's new?"</span>, pub_date=timezone.now())</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; q.save()</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; q.id</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; <span class="number">1</span></div><div class="line"><span class="meta">&gt;&gt;</span>&gt; q.question_text</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; <span class="string">"What's new?"</span></div><div class="line"><span class="meta">&gt;&gt;</span>&gt; q.choice_set.create(choice_text=<span class="string">'Not much'</span>, votes=<span class="number">0</span>)</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; &lt;<span class="symbol">Choice:</span> Not much&gt;</div><div class="line">&gt;&gt;&gt; q.choice_set.create(choice_text=<span class="string">'The sky'</span>, votes=<span class="number">0</span>)</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; &lt;<span class="symbol">Choice:</span> The sky&gt;</div><div class="line">&gt;&gt;&gt; c = q.choice_set.create(choice_text=<span class="string">'Just hacking again'</span>, votes=<span class="number">0</span>)</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; c.question</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; &lt;<span class="symbol">Question:</span> What<span class="string">'s new?&gt;</span></div><div class="line">&gt;&gt;&gt; q.choice_set.all()</div><div class="line">&gt;&gt;&gt; [&lt;Choice: Not much&gt;, &lt;Choice: The sky&gt;, &lt;Choice: Just hacking again&gt;]</div><div class="line">&gt;&gt;&gt; exit()</div></pre></td></tr></table></figure>
<p>至此，我们已经添加了一部分数据到db中了，我们可以通过django下的一个后台管理模块来查看我们插入的数据。</p>
<p>执行：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python manage<span class="selector-class">.py</span> createsuperuser</div></pre></td></tr></table></figure>
<p>创建用户。</p>
<p>将我们的app注册到admin中。</p>
<p>polls/admin.py：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">from django<span class="selector-class">.contrib</span> import admin</div><div class="line">from <span class="selector-class">.models</span> import Question</div><div class="line"></div><div class="line">admin<span class="selector-class">.site</span><span class="selector-class">.register</span>(Question)</div></pre></td></tr></table></figure>
<p>输入<a href="http://localhost:8000/admin/" target="_blank" rel="external">http://localhost:8000/admin/</a> 就可以访问后台了。</p>
<p><img src="/img/django_01_02.png" alt="admin page"></p>
<h3 id="配置views_和_urls">配置views 和 urls</h3><p>views写入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render,HttpResponse</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">detail</span><span class="params">(request, question_id)</span>:</span></div><div class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">"You're looking at question %s."</span> % question_id)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">results</span><span class="params">(request, question_id)</span>:</span></div><div class="line">    response = <span class="string">"You're looking at the results of question %s."</span></div><div class="line">    <span class="keyword">return</span> HttpResponse(response % question_id)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">vote</span><span class="params">(request, question_id)</span>:</span></div><div class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">"You're voting on question %s."</span> % question_id)</div></pre></td></tr></table></figure>
<p>polls/urls.py：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url</div><div class="line"></div><div class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</div><div class="line"></div><div class="line">urlpatterns = [</div><div class="line">    <span class="comment"># ex: /polls/</span></div><div class="line">    url(<span class="string">r'^$'</span>, views.index, name=<span class="string">'index'</span>),</div><div class="line">    <span class="comment"># ex: /polls/5/</span></div><div class="line">    url(<span class="string">r'^(?P&lt;question_id&gt;[0-9]+)/$'</span>, views.detail, name=<span class="string">'detail'</span>),</div><div class="line">    <span class="comment"># ex: /polls/5/results/</span></div><div class="line">    url(<span class="string">r'^(?P&lt;question_id&gt;[0-9]+)/results/$'</span>, views.results, name=<span class="string">'results'</span>),</div><div class="line">    <span class="comment"># ex: /polls/5/vote/</span></div><div class="line">    url(<span class="string">r'^(?P&lt;question_id&gt;[0-9]+)/vote/$'</span>, views.vote, name=<span class="string">'vote'</span>),</div><div class="line">]</div></pre></td></tr></table></figure>
<p>其中：<br>?P<question_id>定义的名称，是用于识别和匹配模式；[0-9]是一个正则表达式匹配一个数字序列（即一个数）</question_id></p>
<p>当然如果你想要的话，也可以写死一个url：<br><code>url(r&#39;^polls/latest\.html$&#39;, views.index),</code><br>但是django不建议这么做。</p>
<p>接下来我们可以将models的数据信息显示在view界面上了：</p>
<p>views.py:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Question</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request)</span>:</span></div><div class="line">    latest_question_list = Question.objects.order_by(<span class="string">'-pub_date'</span>)[:<span class="number">5</span>]</div><div class="line">    output = <span class="string">', '</span>.join([q.question_text <span class="keyword">for</span> q <span class="keyword">in</span> latest_question_list])</div><div class="line">    <span class="keyword">return</span> HttpResponse(output)</div></pre></td></tr></table></figure>
<p>但是这样写前台界面实在太不友好，我们要引入模版机制，将数据信息渲染到html页面上：</p>
<p>创建polls/templates/polls/index.html</p>
<p>用django特有的模版语言写入：</p>
<figure class="highlight django"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name"><span class="name">if</span></span> latest_question_list %&#125;</span><span class="xml"></span></div><div class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">    <span class="template-tag">&#123;% <span class="name"><span class="name">for</span></span> question <span class="keyword">in</span> latest_question_list %&#125;</span><span class="xml"></span></div><div class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/polls/</span></span><span class="template-variable">&#123;&#123; question.id &#125;&#125;</span><span class="xml"><span class="tag"><span class="string">/"</span>&gt;</span></span><span class="template-variable">&#123;&#123; question.question_text &#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></div><div class="line">    <span class="template-tag">&#123;% <span class="name"><span class="name">endfor</span></span> %&#125;</span><span class="xml"></span></div><div class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">else</span></span> %&#125;</span><span class="xml"></span></div><div class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>No polls are available.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">endif</span></span> %&#125;</span><span class="xml"></span></div></pre></td></tr></table></figure>
<p>这些模版语言都是比较易懂的流程控制语句，相信不用解释也可以理解。</p>
<p>修改views.py:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</div><div class="line"><span class="keyword">from</span> django.template <span class="keyword">import</span> loader</div><div class="line"></div><div class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Question</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request)</span>:</span></div><div class="line">    latest_question_list = Question.objects.order_by(<span class="string">'-pub_date'</span>)[:<span class="number">5</span>]</div><div class="line">    template = loader.get_template(<span class="string">'polls/index.html'</span>)</div><div class="line">    context = &#123;</div><div class="line">        <span class="string">'latest_question_list'</span>: latest_question_list,</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> HttpResponse(template.render(context, request))</div></pre></td></tr></table></figure>
<p>还有一种更快捷的写法，使用django封装好的render()方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</div><div class="line"></div><div class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Question</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request)</span>:</span></div><div class="line">    latest_question_list = Question.objects.order_by(<span class="string">'-pub_date'</span>)[:<span class="number">5</span>]</div><div class="line">    context = &#123;<span class="string">'latest_question_list'</span>: latest_question_list&#125;</div><div class="line">    <span class="keyword">return</span> render(request, <span class="string">'polls/index.html'</span>, context)</div></pre></td></tr></table></figure>
<p>创建polls/templates/polls/detail.html,并写入：</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123; question &#125;&#125;</div></pre></td></tr></table></figure>
<p>polls/views.py：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> get_object_or_404, render</div><div class="line"></div><div class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Question</div><div class="line"><span class="comment"># ...</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">detail</span><span class="params">(request, question_id)</span>:</span></div><div class="line">    question = get_object_or_404(Question, pk=question_id)</div><div class="line">    <span class="keyword">return</span> render(request, <span class="string">'polls/detail.html'</span>, &#123;<span class="string">'question'</span>: question&#125;)</div></pre></td></tr></table></figure>
<p>这里我们可以看到404的处理都单独封装了一个方法，django这么处理的原因是为了防止模型层和视图层的耦合，因为404是比较常见的一种错误，而且处理404的判断如果放在了界面层，那么对models的处理就和view层耦合太重。</p>
<p>现在访问：<code>http://localhost:8000/polls</code>就能看到载入模版之后的样子了。</p>
<p><img src="/img/django_01_03.png" alt="add template"></p>
<p>内容页面：</p>
<p><img src="/img/django_01_04.png" alt="details"></p>
<p>注意这里有个细节：</p>
<p>polls/index.html中的a标签的链接我们用了硬编码，为了更好的实现可扩展性，我们将其中的:</p>
<figure class="highlight django"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/polls/</span></span></span><span class="template-variable">&#123;&#123; question.id &#125;&#125;</span><span class="xml"><span class="tag"><span class="string">/"</span>&gt;</span></span><span class="template-variable">&#123;&#123; question.question_text &#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></div></pre></td></tr></table></figure>
<p>改为：</p>
<figure class="highlight django"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"</span></span></span><span class="template-tag">&#123;% <span class="name"><span class="name">url</span></span> 'detail' question.id %&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span><span class="template-variable">&#123;&#123; question.question_text &#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></div></pre></td></tr></table></figure>
<p>可以看出来新的写法会去找<code>name</code>属性为<code>ditail</code>的url进行匹配。</p>
<h3 id="form的实现">form的实现</h3><p>修改我们的<br><code>polls/templates/polls/detail.html</code>:</p>
<figure class="highlight django"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><span class="template-variable">&#123;&#123; question.question_text &#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></div><div class="line"></div><div class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">if</span></span> error_message %&#125;</span><span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span></span><span class="template-variable">&#123;&#123; error_message &#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><span class="template-tag">&#123;% <span class="name"><span class="name">endif</span></span> %&#125;</span><span class="xml"></span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"</span></span><span class="template-tag">&#123;% <span class="name"><span class="name">url</span></span> 'polls:vote' question.id %&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span></div><div class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">csrf_token</span></span> %&#125;</span><span class="xml"></span></div><div class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">for</span></span> choice <span class="keyword">in</span> question.choice_set.all %&#125;</span><span class="xml"></span></div><div class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"choice"</span> <span class="attr">id</span>=<span class="string">"choice</span></span><span class="template-variable">&#123;&#123; forloop.counter &#125;&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> <span class="attr">value</span>=<span class="string">"</span></span></span><span class="template-variable">&#123;&#123; choice.id &#125;&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> /&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"choice</span></span><span class="template-variable">&#123;&#123; forloop.counter &#125;&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span><span class="template-variable">&#123;&#123; choice.choice_text &#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">label</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span></div><div class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">endfor</span></span> %&#125;</span><span class="xml"></span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Vote"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div></pre></td></tr></table></figure>
<p>view界面加入投票逻辑：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> get_object_or_404, render</div><div class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponseRedirect, HttpResponse</div><div class="line"><span class="keyword">from</span> django.core.urlresolvers <span class="keyword">import</span> reverse</div><div class="line"></div><div class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Choice, Question</div><div class="line"><span class="comment"># ...</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">vote</span><span class="params">(request, question_id)</span>:</span></div><div class="line">    question = get_object_or_404(Question, pk=question_id)</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        selected_choice = question.choice_set.get(pk=request.POST[<span class="string">'choice'</span>])</div><div class="line">    <span class="keyword">except</span> (KeyError, Choice.DoesNotExist):</div><div class="line">        <span class="comment"># Redisplay the question voting form.</span></div><div class="line">        <span class="keyword">return</span> render(request, <span class="string">'polls/detail.html'</span>, &#123;</div><div class="line">            <span class="string">'question'</span>: question,</div><div class="line">            <span class="string">'error_message'</span>: <span class="string">"You didn't select a choice."</span>,</div><div class="line">        &#125;)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        selected_choice.votes += <span class="number">1</span></div><div class="line">        selected_choice.save()</div><div class="line">        <span class="comment"># Always return an HttpResponseRedirect after successfully dealing</span></div><div class="line">        <span class="comment"># with POST data. This prevents data from being posted twice if a</span></div><div class="line">        <span class="comment"># user hits the Back button.</span></div><div class="line">        <span class="keyword">return</span> HttpResponseRedirect(reverse(<span class="string">'polls:results'</span>, args=(question.id,)))<span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> get_object_or_404, render</div><div class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponseRedirect, HttpResponse</div><div class="line"><span class="keyword">from</span> django.core.urlresolvers <span class="keyword">import</span> reverse</div><div class="line"></div><div class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> Choice, Question</div><div class="line"><span class="comment"># ...</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">vote</span><span class="params">(request, question_id)</span>:</span></div><div class="line">    question = get_object_or_404(Question, pk=question_id)</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        selected_choice = question.choice_set.get(pk=request.POST[<span class="string">'choice'</span>])</div><div class="line">    <span class="keyword">except</span> (KeyError, Choice.DoesNotExist):</div><div class="line">        <span class="comment"># Redisplay the question voting form.</span></div><div class="line">        <span class="keyword">return</span> render(request, <span class="string">'polls/detail.html'</span>, &#123;</div><div class="line">            <span class="string">'question'</span>: question,</div><div class="line">            <span class="string">'error_message'</span>: <span class="string">"You didn't select a choice."</span>,</div><div class="line">        &#125;)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        selected_choice.votes += <span class="number">1</span></div><div class="line">        selected_choice.save()</div><div class="line">        <span class="comment"># Always return an HttpResponseRedirect after successfully dealing</span></div><div class="line">        <span class="comment"># with POST data. This prevents data from being posted twice if a</span></div><div class="line">        <span class="comment"># user hits the Back button.</span></div><div class="line">        <span class="keyword">return</span> HttpResponseRedirect(reverse(<span class="string">'polls:results'</span>, args=(question.id,)))</div></pre></td></tr></table></figure>
<p>其中：</p>
<p>reverse()方法  用于返回一个url，这里直接返回polls/1/vote/</p>
<p>定义投票的结果页面：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">results</span><span class="params">(request, question_id)</span>:</span></div><div class="line">    question = get_object_or_404(Question, pk=question_id)</div><div class="line">    <span class="keyword">return</span> render(request, <span class="string">'polls/results.html'</span>, &#123;<span class="string">'question'</span>: question&#125;)</div></pre></td></tr></table></figure>
<p>以及模版页面：<br><code>polls/results.html</code>:</p>
<figure class="highlight django"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><span class="template-variable">&#123;&#123; question.question_text &#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">for</span></span> choice <span class="keyword">in</span> question.choice_set.all %&#125;</span><span class="xml"></span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="template-variable">&#123;&#123; choice.choice_text &#125;&#125;</span><span class="xml"> -- </span><span class="template-variable">&#123;&#123; choice.votes &#125;&#125;</span><span class="xml"> vote</span><span class="template-variable">&#123;&#123; choice.votes|<span class="name">pluralize</span> &#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></div><div class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">endfor</span></span> %&#125;</span><span class="xml"></span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"</span></span><span class="template-tag">&#123;% <span class="name"><span class="name">url</span></span> 'polls:detail' question.id %&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span>Vote again?<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></div></pre></td></tr></table></figure>
<h3 id="静态文件的加载">静态文件的加载</h3><p>创建一个css文件：<code>polls/static/polls/style.css</code>并写入：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">li</span> <span class="selector-tag">a</span> &#123;</div><div class="line">    <span class="attribute">color</span>: green;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在polls/templates/polls/index.html文件中引入这个css</p>
<figure class="highlight django"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name"><span class="name">load</span></span> staticfiles %&#125;</span><span class="xml"></span></div><div class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"</span></span><span class="template-tag">&#123;% <span class="name"><span class="name">static</span></span> 'polls/style.css' %&#125;</span><span class="xml"><span class="tag"><span class="string">"</span> /&gt;</span></span></div></pre></td></tr></table></figure>
<p>接下来添加一个图片：<br><code>polls/static/polls/images/background.gif.</code></p>
<p>修改<code>polls/static/polls/style.css</code>加入：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">body</span> &#123;</div><div class="line">    <span class="attribute">background</span>: white <span class="built_in">url</span>(<span class="string">"images/background.gif"</span>) no-repeat right bottom;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>可看到执行效果：</p>
<p><img src="/img/django_01_05.png" alt="css"></p>
<h3 id="自定义后台页面">自定义后台页面</h3><p>Django经常被用来开发后台应用，因为它有一个非常强大的，可灵活配置的后台应用。这个admin应用就是<code>settings.py</code>中的<code>INSTALLED_APPS</code>下的<code>django.contrib.admin</code>。</p>
<p>前面我们在polls项目下的admin.py中将我们的<code>Question</code>注册到了admin中，我们在后台页面可以看到了Question表的相关信息。那么如果我们想把<code>Choice</code>的相关信息也显示出来需要怎么处理呢？</p>
<p>有一种做法就是也仿照<code>Question</code>将<code>Choice</code>注册进入admin：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">from django<span class="selector-class">.contrib</span> import admin</div><div class="line">from <span class="selector-class">.models</span> import Question,Choice</div><div class="line"></div><div class="line">admin<span class="selector-class">.site</span><span class="selector-class">.register</span>(Question)</div><div class="line">admin<span class="selector-class">.site</span><span class="selector-class">.register</span>(Choice)</div></pre></td></tr></table></figure>
<p>但这样并不好，因为Choice和Question存在一对多的外键关联，我们直接显示出来，并不能很好的体现出这层含义。为了解决这个问题，我们可以引入<code>ModelAdmin</code>，将Question注册到一个自定义的<code>ModelAdmin</code>上，定义其内联元素为一个Choice。</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="title">from</span> .models <span class="keyword">import</span> Question,Choice</div><div class="line"><span class="class"></span></div><div class="line"><span class="keyword">class</span> <span class="type">ChoiceInline</span>(<span class="title">admin</span>.<span class="type">StackedInline</span>):</div><div class="line">    model = <span class="type">Choice</span></div><div class="line">    extra = 0</div><div class="line"></div><div class="line"><span class="keyword">class</span> <span class="type">QuestionAdmin</span>(<span class="title">admin</span>.<span class="type">ModelAdmin</span>):</div><div class="line">    inlines = [<span class="type">ChoiceInline</span>]</div><div class="line"></div><div class="line">admin.site.register(<span class="type">Question</span>,<span class="type">QuestionAdmin</span>)</div></pre></td></tr></table></figure>
<p>在Question的详情页面里，我们就可以看到作为内联样式展示的Choices了：</p>
<p><img src="/img/django_01_06.png" alt="内联"></p>
<p>接下来我们可以通过对<code>QuestionAdmin</code>简单的配置，实现一个功能更加强大的后台界面：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">QuestionAdmin</span><span class="params">(admin.ModelAdmin)</span>:</span></div><div class="line">	<span class="comment"># 详情页加入更多字段的显示</span></div><div class="line">    fieldsets = [</div><div class="line">        (<span class="keyword">None</span>,               &#123;<span class="string">'fields'</span>: [<span class="string">'question_text'</span>]&#125;),</div><div class="line">        (<span class="string">'Date information'</span>, &#123;<span class="string">'fields'</span>: [<span class="string">'pub_date'</span>], <span class="string">'classes'</span>: [<span class="string">'collapse'</span>]&#125;),</div><div class="line">    ]</div><div class="line">    inlines = [ChoiceInline]</div><div class="line">    </div><div class="line">    <span class="comment"># 列表页面加入更多字段的显示</span></div><div class="line">    list_display = (<span class="string">'question_text'</span>, <span class="string">'pub_date'</span>, <span class="string">'was_published_recently'</span>)</div><div class="line">    </div><div class="line">    <span class="comment"># 在列表页面右侧加入过滤功能</span></div><div class="line">    list_filter = [<span class="string">'pub_date'</span>]</div><div class="line">    <span class="comment"># 加入搜索功能</span></div><div class="line">    search_fields = [<span class="string">'question_text'</span>]</div></pre></td></tr></table></figure>
<p>实现效果如下：</p>
<p><img src="/img/django_01_07.png" alt="完整后台"></p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/01/06/机器学习(04)Logistic回归/" itemprop="url">
                机器学习(04)Logistic回归
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2016-01-06T23:26:55+08:00" content="2016-01-06">
            2016-01-06
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/机器学习/" itemprop="url" rel="index">
                  <span itemprop="name">机器学习</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2016/01/06/机器学习(04)Logistic回归/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2016/01/06/机器学习(04)Logistic回归/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h2 id="什么是Logistic回归">什么是Logistic回归</h2><h3 id="什么是回归？">什么是<strong>回归</strong>？</h3><p>假设现在有一些数据点，我们用一条直线对这些点进行拟合（该线称为最佳拟合直线），这个拟合过程就称作<strong>回归</strong>。</p>
<p>Logistic回归分类的主要思想是：根据现有数据边界线建立回归公式，以此进行分类。这里的<code>&quot;回归&quot;</code>一词，源于最佳拟合，在训练分类器时的主要做法就是寻找最佳拟合参数集，这其中运用到的就是<strong>最优化算法</strong>(可以找到最优解的算法)。</p>
<p>其中回归过程中运用到的数学原理的核心，就是<strong>Logistic函数</strong>。</p>
<h3 id="什么是Logistic">什么是Logistic</h3><blockquote>
<p><strong>Logistic函数</strong>或<strong>Logistic曲线</strong>是一种常见的S形函数，它是皮埃尔·弗朗索瓦·韦吕勒在1844或1845年在研究它与人口增长的关系时命名的。广义Logistic曲线可以模仿一些情况人口增长（P）的S形曲线。起初阶段大致是指数增长；然后随着开始变得饱和，增加变慢；最后，达到成熟时增加停止。</p>
</blockquote>
<h3 id="举个栗子">举个栗子</h3><p>简单来说如果想了解到底哪些因素是胃癌的危险因素，我们就可以使用Logistic回归来处理。</p>
<p>想探讨胃癌发生的危险因素，可以选择两组人群，一组是胃癌组，一组是非胃癌组，两组人群肯定有不同的体征和生活方式等。这里的因变量就是是否胃癌，即“是”或“否”，为两分类变量，自变量就可以包括很多了，例如年龄、性别、饮食习惯、幽门螺杆菌感染等。自变量既可以是连续的，也可以是分类的。通过Logistic回归分析，我们可以大致了解到底哪些因素是胃癌的危险因素。</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/01/06/Scala(01)基础/" itemprop="url">
                Scala(01)
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2016-01-06T09:43:55+08:00" content="2016-01-06">
            2016-01-06
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/scala/" itemprop="url" rel="index">
                  <span itemprop="name">scala</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2016/01/06/Scala(01)基础/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2016/01/06/Scala(01)基础/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h2 id="Scala安装">Scala安装</h2><h2 id="Scala解释器">Scala解释器</h2></span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2016/01/05/Numpy快速入门/" itemprop="url">
                NumPy快速入门
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2016-01-05T11:43:55+08:00" content="2016-01-05">
            2016-01-05
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/python/" itemprop="url" rel="index">
                  <span itemprop="name">python</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2016/01/05/Numpy快速入门/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2016/01/05/Numpy快速入门/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h2 id="NumPy快速入门">NumPy快速入门</h2><h3 id="为什么需要NumPy?">为什么需要NumPy?</h3><p>NumPy是python的一个矩阵类型，提供了大量的矩阵处理的函数。</p>
<p>由于其内部是通过<strong>C语言</strong>来实现，所以效率很高。</p>
<p>尽管声称是一个关于矩阵的库，NumPy实际上包含了两种基本的数据类型：数组和矩阵。二者在处理上稍有不同。在使用标准的python时，处理这两类数据，均需要使用循环语句，而使用NumPy则可以省去这些语句。</p>
<h2 id="数组">数组</h2><h3 id="数组相加">数组相加</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> numpy <span class="keyword">import</span> array</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>mm=array((<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>))</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>pp=array((<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>))</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>pp+mm</div><div class="line">array([<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</div></pre></td></tr></table></figure>
<p>如果使用常规的python，就需要循环来处理了。</p>
<h3 id="数组的数乘运算">数组的数乘运算</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>pp*<span class="number">2</span></div><div class="line">array([<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>])</div></pre></td></tr></table></figure>
<h3 id="对每个元素求平方">对每个元素求平方</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>pp**<span class="number">2</span></div><div class="line">array([<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>])</div></pre></td></tr></table></figure>
<h3 id="可以像列表中一样访问数组里的元素：">可以像列表中一样访问数组里的元素：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>pp[<span class="number">1</span>]</div><div class="line"><span class="number">1</span></div></pre></td></tr></table></figure>
<p>NumPy中也支持多维数组：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>jj = array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],[<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]])</div></pre></td></tr></table></figure>
<p>多维数组中的元素也可以像列表中一样访问：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>jj[<span class="number">0</span>]</div><div class="line">array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>jj[<span class="number">0</span>][<span class="number">1</span>]</div><div class="line"><span class="number">2</span></div></pre></td></tr></table></figure>
<p>也可以用矩阵方式访问：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>jj[<span class="number">0</span>, <span class="number">1</span>]</div><div class="line"><span class="number">2</span></div></pre></td></tr></table></figure>
<h3 id="把两个数组乘起来的时候，两个数组的元素将对应相乘：">把两个数组乘起来的时候，两个数组的元素将对应相乘：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a1=array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a2=array([<span class="number">0.3</span>, <span class="number">0.2</span>, <span class="number">0.3</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a1*a2</div><div class="line">array([<span class="number">0.3</span>, <span class="number">0.4</span> <span class="number">0.9</span>])</div></pre></td></tr></table></figure>
<h2 id="矩阵">矩阵</h2><h3 id="Numpy矩阵的引入">Numpy矩阵的引入</h3><p>与数组一样，需要从NumPy中导入<code>matrix</code>或者<code>mat</code>模块(<code>mat</code>其实就是<code>matrix</code>的缩写)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> numpy <span class="keyword">import</span> mat, matrix</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>ss = mat([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>ss</div><div class="line">matrix([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>mm = matrix([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>mm</div><div class="line">matrix([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]])</div></pre></td></tr></table></figure>
<p>可以访问矩阵中的单个元素：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>mm[<span class="number">0</span>,<span class="number">1</span>]</div><div class="line"><span class="number">2</span></div></pre></td></tr></table></figure>
<h3 id="将python列表转换为NumPy矩阵">将python列表转换为NumPy矩阵</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>pyList = [<span class="number">5</span>, <span class="number">11</span>, <span class="number">1605</span>]</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>mat(pyList)</div><div class="line">matrix([[   <span class="number">5</span>,   <span class="number">11</span>, <span class="number">1605</span>]])</div></pre></td></tr></table></figure>
<h3 id="矩阵乘法的运算">矩阵乘法的运算</h3><p>如果你不熟悉矩阵乘法的运算规则，请看<a href="./2015/11/29/线性代数01-矩阵乘法/">这里</a>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>ss = mat([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>mm = matrix([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>mm*ss.T</div><div class="line">matrix([[<span class="number">14</span>]])</div></pre></td></tr></table></figure>
<p>其中<code>ss.T</code>是将ss进行转置，因为做矩阵乘法运算的两个矩阵必须满足<code>左矩阵的列数与右矩阵的行数相等</code>的条件。</p>
<h3 id="获取矩阵的行列数">获取矩阵的行列数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> numpy <span class="keyword">import</span> shape</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>mm = matrix([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>shape(mm)</div><div class="line">(<span class="number">1</span>, <span class="number">3</span>)</div></pre></td></tr></table></figure>
<h3 id="两个矩阵对应元素相乘(multiply)">两个矩阵对应元素相乘(multiply)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> numpy <span class="keyword">import</span> multiply</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>mm = matrix([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>ss = matrix([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>multiply(mm, ss)</div><div class="line">matrix([[<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>]])</div></pre></td></tr></table></figure>
<h3 id="矩阵的排序">矩阵的排序</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>d = matrix([<span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>d.sort()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>d</div><div class="line">matrix([[<span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>]])</div></pre></td></tr></table></figure>
<p>注意：该方法是原地排序（即排序后到结果占用原始的存储空间），所以如果希望保存数据的原始顺序，必须事先拷贝一份。也可以使用argsort()方法得到矩阵中每个元素的排序序号：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>d = matrix([<span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>d.argsort()</div><div class="line">matrix([[<span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>]])</div></pre></td></tr></table></figure>
<h3 id="计算矩阵的平均值">计算矩阵的平均值</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>d = matrix([<span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>d.mean()</div><div class="line"><span class="number">3.3333333333333335</span></div></pre></td></tr></table></figure>
<h3 id="通过:去除矩阵中指定片段">通过<code>:</code>去除矩阵中指定片段</h3><p>python中的切片用法简单，功能强大，NumPy中的矩阵同样也支持该操作，比如在想在下面一个2x3的矩阵中取出第一行元素：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>jj = mat([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],[<span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>]])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>shape(jj)</div><div class="line">(<span class="number">2</span>, <span class="number">3</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>jj[<span class="number">1</span>,:]</div><div class="line">matrix([[<span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>]])</div></pre></td></tr></table></figure>
<p>也可以使用以下方法取出第一行第0列到第1列的元素：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>jj[<span class="number">1</span>,<span class="number">0</span>:<span class="number">2</span>]</div><div class="line">matrix([[<span class="number">8</span>, <span class="number">8</span>]])</div></pre></td></tr></table></figure>
<h3 id="更多">更多</h3><p>更多NumPy的相关用法，建议浏览完整的官方文档</p>
<p><a href="http://docs.scipy.org/doc/" target="_blank" rel="external">http://docs.scipy.org/doc/</a></p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/12/27/机器学习(03)朴素贝叶斯构建敏感词过滤系统/" itemprop="url">
                机器学习(03)朴素贝叶斯构建敏感词过滤系统
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-12-27T12:08:55+08:00" content="2015-12-27">
            2015-12-27
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/机器学习/" itemprop="url" rel="index">
                  <span itemprop="name">机器学习</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2015/12/27/机器学习(03)朴素贝叶斯构建敏感词过滤系统/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2015/12/27/机器学习(03)朴素贝叶斯构建敏感词过滤系统/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h2 id="贝叶斯理论入门">贝叶斯理论入门</h2><h3 id="贝叶斯？">贝叶斯？</h3><blockquote>
<p>贝叶斯概率以18世纪的一位神学家<strong>托马斯·贝叶斯<code>(Thomas Bayes)</code></strong>的名字命名。贝叶斯概率引入先验知识和逻辑推理来处理不确定命题。另一种概率解释称为频数概率<code>(frequency probability)</code>,它只从数据本身获得结论，并不考虑逻辑推理及先验知识。</p>
</blockquote>
<p><strong>朴素贝叶斯</strong>中的<strong>朴素</strong>一词的含义是指：整个形式化过程，我们只做最原始、最简单的假设。(如果你不理解这句话的含义，不要担心，后面我们会详细讲解的)。</p>
<h3 id="条件概率与贝叶斯准则">条件概率与贝叶斯准则</h3><p>如果你对$p(x,y|c_1)$符号很熟悉，那么请跳过本段</p>
<h4 id="条件概率定义:">条件概率定义:</h4><blockquote>
<p>事件A在另外一个事件B已经发生条件下的发生概率。条件概率表示为<strong>P(A|B)</strong>，读作“在B条件下A的概率”。</p>
</blockquote>
<h4 id="举个栗子：">举个栗子：</h4><p>假设现在有一个装了7块石头的罐子，其中3块是灰色的，4块是黑色的，如果从罐子里随即取出一块石头，那么是灰色石头的可能性是多少？很显然，答案是3/7。</p>
<p>那么如果把这些石头分别放到两个桶中，A桶中为2块灰色2块黑色，B桶中为1块灰色2块黑色，那么取出灰色石头的概率又该如何计算呢？</p>
<p>要计算$P(gray)$或者$P(black)$,事先得知道石头所在桶的信息会不会改变结果。你有可能已经想到计算从B桶中取到灰色石头的概率的方法，这就是所谓的<strong>条件概率<code>(conditional probability)</code></strong>。</p>
<p>假定计算的是从B桶取到灰色石头的概率，这个概率可以记作$P(gray|bucketB)$,我们称之为“在已知石头出自B桶的条件下，取出灰色石头的概率”。不难得到，$P(gray|bucketA)$值为2/4,$P(gray|bucketB)$的值为1/3。</p>
<p>记从B桶中取出灰色石头的概率为：$P(gray and bucketB)$，石头出自B桶的概率为$P(pucketB)$，那么条件概率计算公式如下：</p>
<p>$$P(gray|bucketB) = P(gray and bucketB)/P(bucketB)$$</p>
<h4 id="贝叶斯准则">贝叶斯准则</h4><p>另一种有效计算条件概率的方法称为<strong>贝叶斯准则</strong>。贝叶斯准则告诉我们如何交换条件概率中的条件与结果，即如果已知$p(x|c)$,要求$p(c|x)$,那么可以使用下面的计算方法：</p>
<p>$$<br>p(c|x) = \dfrac{p(x|c)p(c)}{p(x)}<br>$$</p>
<h3 id="基本原理">基本原理</h3><p>假设有一个数据集，它由两类数据组成，数据分布如下图所示：</p>
<p><img src="/img/ml_03_01.png" alt="朴素贝叶斯图例"></p>
<p>其中不同形状代表不同的数据类型。</p>
<p>我们现在用<strong>$p1(x,y)$</strong>表示数据点$(x,y)$属于类别1<em>(图中圆点表示的类型)</em>的概率，用<strong>$p2(x,y)$</strong>表示数据点$(x,y)$属于类别2<em>(图中三角形表示的类型)</em>的概率。</p>
<p>那么对于一个新的数据点$(x,y)$，我们可以通过以下规则来判断它所属于的类型：</p>
<ul>
<li>如果$p1(x,y) &gt; p2(x,y)$，那么类型为1</li>
<li>如果$p1(x,y) &lt; p2(x,y)$，那么类型为2</li>
</ul>
<h2 id="使用朴素贝叶斯进行文档分类">使用朴素贝叶斯进行文档分类</h2><p>机器学习的一个重要应用就是文档的自动分类。对例如用户留言，邮件内容等任意类型的文本进行分类，我们可以观察文档中出现的词，并把每个词的出现或者不出现作为一个特征，这样得到的特征数目就会跟词汇表中的词目一样多。</p>
<h3 id="两个假设前提">两个假设前提</h3><blockquote>
<p>我们使用的朴素贝叶斯进行文档分类时，需要建立在两个假设前提之上的，虽然这两个假设前提有一些瑕疵，但实际情况证明，贝叶斯工作的效果很好。</p>
</blockquote>
<p>假设词汇表中有1000个单词。要得到好的概率分布，就需要足够的数据样本，假定样本数为$N$。由统计学可知，如果每个特征需要$N$个样本，那么对于10个特征将需要$N^{10}$个样本，对于包含1000个特征的词汇表，将需要$N^{1000}$个样本。可以看到，所需要的样本书会随着特征数目的增大而迅速增长。</p>
<p><strong>假设1:特征之间相互独立</strong>，那么样本数就可以从$N^{1000}$减少到$1000N$了。</p>
<p><strong>假设2:每个特征同等重要</strong>。</p>
<blockquote>
<p>注释：<strong>特征之间相互独立</strong>指的是统计意义上的独立，即一个特征的出现的可能性不受其他特征所影响。 举个例子来说明：比如单词A出现在B后面的概率和出现在C后面的概率相同。很明显这种情况很不靠谱，这也正是<strong>朴素贝叶斯</strong>中<strong>朴素</strong>一词的含义。</p>
</blockquote>
<h3 id="实现效果">实现效果</h3><p>接下来我们要用python代码来实现一个侮辱性词汇过滤系统，要用到我们刚才学习的朴素贝叶斯的知识。也许你会问，构建一个侮辱性词汇集合的数据库，遇到了侮辱性词汇，就认定这个文本为侮辱性文本，不就可以很好的解决这个问题了吗？何必要用贝叶斯呢？</p>
<p>首先不否认这也是一种实现思路，但我们要做的过滤系统的最终效果将是由人工去判断样本数据是否为侮辱性的文本，然后剩下的就可以交给机器，机器会自动识别出侮辱性词汇，以及判断待测试数据是侮辱性文本的可能性和非侮辱性文本的可能性，取概率较大的作为判定结果来标识出侮辱性的文本。</p>
<h3 id="数据的处理">数据的处理</h3><p>想要从一个文本中获取特征，首先需要<strong>拆分文本</strong>。这里的特征来自于文本的<strong>词条<code>(token)</code></strong>，我们可以把词条理解为单个单词。我们将出现在所有的文本中的词条做一个<strong>不重复的集合</strong>，然后对每一条文本进行标识，如果对应文本中对应位置的词条没有出现记为0，出现记为1。这样我们可以得到一系列用来标识文本片段特征的由0和1组成的列表，这个列表我们称为<strong>词条向量</strong>。</p>
<h3 id="代码实现">代码实现</h3><h4 id="准备数据：从文本中构建词条向量">准备数据：从文本中构建词条向量</h4><p><strong>构建数据源：</strong>首先创建数据源，获取所有文本词条集合以及对应类型集合，这里省略分词部分逻辑。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">loadDataSet</span><span class="params">()</span>:</span></div><div class="line">    <span class="comment"># 文本集合，每条文本中都有若干条词条</span></div><div class="line">    postingList = [[<span class="string">'my'</span>, <span class="string">'dog'</span>, <span class="string">'has'</span>, <span class="string">'flea'</span>, <span class="string">'problems'</span>, <span class="string">'help'</span>, <span class="string">'please'</span>],</div><div class="line">                   [<span class="string">'maybe'</span>, <span class="string">'not'</span>, <span class="string">'take'</span>, <span class="string">'him'</span>, <span class="string">'to'</span>, <span class="string">'dog'</span>, <span class="string">'park'</span>, <span class="string">'stupid'</span>],</div><div class="line">                   [<span class="string">'my'</span>, <span class="string">'dalmation'</span>, <span class="string">'is'</span>, <span class="string">'so'</span>, <span class="string">'cute'</span>, <span class="string">'I'</span>, <span class="string">'love'</span>, <span class="string">'him'</span>],</div><div class="line">                   [<span class="string">'stop'</span>, <span class="string">'posting'</span>, <span class="string">'stupid'</span>, <span class="string">'worthless'</span>, <span class="string">'garbage'</span>],</div><div class="line">                   [<span class="string">'mr'</span>, <span class="string">'licks'</span>, <span class="string">'ate'</span>, <span class="string">'my'</span>, <span class="string">'steak'</span>, <span class="string">'how'</span>, <span class="string">'to'</span>, <span class="string">'stop'</span>, <span class="string">'him'</span>],</div><div class="line">                   [<span class="string">'quit'</span>, <span class="string">'buying'</span>, <span class="string">'worthless'</span>, <span class="string">'dog'</span>, <span class="string">'food'</span>, <span class="string">'stupid'</span>]</div><div class="line">    ]</div><div class="line">    <span class="comment"># 1代表侮辱性文字，0代表正常言论</span></div><div class="line">    <span class="comment"># 这些数据将由人工标注，用于训练程序以便自动检测侮辱性留言</span></div><div class="line">    classVec = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]</div><div class="line"></div><div class="line">    <span class="keyword">return</span> postingList,classVec</div></pre></td></tr></table></figure>
<p><strong>词条字典构建：</strong>将所有词条集合传入，得到一个所有不重复词条的集合字典</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">createVocabList</span><span class="params">(dataSet)</span>:</span></div><div class="line">    vocabSet = set([])</div><div class="line">    <span class="keyword">for</span> document <span class="keyword">in</span> dataSet:</div><div class="line">        <span class="comment"># '|'操作符可以取两个列表的并集，set()方法可以去除重复项</span></div><div class="line">        vocabSet = vocabSet | set(document)</div><div class="line">    <span class="keyword">return</span> list(vocabSet)</div></pre></td></tr></table></figure>
<p><strong>构建词条向量：</strong>传入词条字典，和待测试的对应文本词条集合，得到词条向量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">setOfWords2Vec</span><span class="params">(vocabList, inputSet)</span>:</span></div><div class="line">    <span class="comment"># 初始化词条向量</span></div><div class="line">    <span class="comment"># [0]*len(vocabList) 可以获得一个和vocabList等长的，全部由0组成的集合</span></div><div class="line">    returnVec = [<span class="number">0</span>]*len(vocabList)</div><div class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> inputSet:</div><div class="line">        <span class="keyword">if</span> word <span class="keyword">in</span> vocabList:</div><div class="line">            <span class="comment"># 如果词条集合中的词条出现在了词条字典中，则将词条向量中的词条对应位置的元素记为1</span></div><div class="line">            returnVec[vocabList.index(word)] = <span class="number">1</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">print</span> <span class="string">"the word: %s is not in my Vocabulary!"</span> % word</div><div class="line">    <span class="keyword">return</span> returnVec</div></pre></td></tr></table></figure>
<p>执行:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">postingList,classVec = loadDataSet()</div><div class="line">print(<span class="string">"------postings------"</span>)</div><div class="line"><span class="keyword">for</span> posting <span class="keyword">in</span> postingList:</div><div class="line">    print(posting)</div><div class="line">print(<span class="string">"------classVec------"</span>)</div><div class="line">print(classVec)</div><div class="line"></div><div class="line">vocabList = createVocabList(postingList)</div><div class="line">print(<span class="string">"------vocabList------"</span>)</div><div class="line">print(vocabList)</div><div class="line"></div><div class="line">print(<span class="string">"------words2Vec------"</span>)</div><div class="line"><span class="keyword">for</span> posting <span class="keyword">in</span> postingList:</div><div class="line">    print(setOfWords2Vec(vocabList,posting))</div></pre></td></tr></table></figure>
<p>输出结果:</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">------postings------</div><div class="line">['my', 'dog', 'has', 'flea', 'problems', 'help', 'please']</div><div class="line">['maybe', 'not', 'take', 'him', 'to', 'dog', 'park', 'stupid']</div><div class="line">['my', 'dalmation', 'is', 'so', 'cute', 'I', 'love', 'him']</div><div class="line">['stop', 'posting', 'stupid', 'worthless', 'garbage']</div><div class="line">['mr', 'licks', 'ate', 'my', 'steak', 'how', 'to', 'stop', 'him']</div><div class="line">['quit', 'buying', 'worthless', 'dog', 'food', 'stupid']</div><div class="line">------classVec------</div><div class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]</div><div class="line">------vocabList------</div><div class="line">['cute', 'love', 'help', 'garbage', 'quit', 'I', 'problems', 'is', 'park', 'stop', 'flea', 'dalmation', 'licks', 'food', 'not', 'him', 'buying', 'posting', 'has', 'worthless', 'ate', 'to', 'maybe', 'please', 'dog', 'how', 'stupid', 'so', 'take', 'mr', 'steak', 'my']</div><div class="line">------words2Vec------</div><div class="line">[<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>]</div><div class="line">[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</div><div class="line">[<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>]</div><div class="line">[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</div><div class="line">[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]</div><div class="line">[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</div></pre></td></tr></table></figure>
<p>这样我们就得到了这六组待测试数据的词条向量。</p>
<h4 id="训练算法：通过词条向量计算是侮辱性评论的概率">训练算法：通过词条向量计算是侮辱性评论的概率</h4><h5 id="问题分析">问题分析</h5><p>前面介绍了如何将一组单词转换为一组数字，接下来看看如何使用这些数字计算概率。</p>
<p>现在我们已经知道了一个词是否出现在一篇文档中，也知道该文档所属的类别。根据前面提到的贝叶斯准则，我们将其中的$x$替换为$\textbf{w}$。<strong>注意：这里的粗体的$\textbf{w}$代表一个向量，即它是由多个值组成。</strong></p>
<p>$$<br>p(c_i|\textbf{w}) = \dfrac{p(\textbf{w}|c_i)p(c_i)}{p(\textbf{w})}<br>$$</p>
<p>我们将使用上述公式，对每个类计算该值，然后比较着两个概率值的大小<code>（这个例子中就是分别计算是侮辱性言论和不是侮辱性言论的概率，比较两种情况的概率大小）</code>。</p>
<p>如何计算呢？</p>
<p><strong>step1:计算$p(c_{i})$</strong></p>
<p>首先可以通过类别i<code>(侮辱性言论或者非侮辱性言论)</code>中文档数除以总的文档数来计算$p(ci)$<code>(对应类别的文档占总文档数的比例)</code></p>
<p><strong>step2:计算$p(\textbf{w}|c_i)$</strong></p>
<p>这里就要用到朴素贝叶斯的假设了。假设$\textbf{w}$展开为一个个独立特征，那么可以将上述概率写作$p(w_0,w_1,w_2..w_n|c_i)$。这里假设所有词都互相独立，该假设也称作<strong>条件独立假设</strong>，它意味着可以使用$p(w_0|c_i)p(w_1|c_i)p(w_2|c_i)..p(w_n|c_i)$来计算上述概率，这就极大的简化了计算的过程。</p>
<h5 id="代码实现：">代码实现：</h5><p>朴素贝叶斯分类器训练函数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># trainMatrix:多个词条向量组成的集合矩阵</span></div><div class="line"><span class="comment"># trainCategory:分类标签集合</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">trainNBO</span><span class="params">(trainMatrix, trainCategory)</span>:</span></div><div class="line">    <span class="comment"># 记录词条向量个数</span></div><div class="line">    numTrainDocs = len(trainMatrix)</div><div class="line">    <span class="comment"># 单个词条向量的长度，即词条字典的长度</span></div><div class="line">    numWords = len(trainMatrix[<span class="number">0</span>])</div><div class="line">    <span class="comment"># 引入numpy后，sum函数可以计算一个集合的所有元素的总和</span></div><div class="line">    <span class="comment"># pAbusive 是所有词条向量中 是侮辱性言论的概率： 3/6 = 0.5</span></div><div class="line">    pAbusive = sum(trainCategory) / float(numTrainDocs)</div><div class="line"></div><div class="line">    <span class="comment"># 初始化 侮辱性/非侮辱性 言论中 词条分布总和向量</span></div><div class="line">    <span class="comment"># 引入numpy后,zeros(numWords)方法用来得到一个和numWords等长的0矩阵</span></div><div class="line">    p0Num = zeros(numWords)</div><div class="line">    p1Num = zeros(numWords)</div><div class="line">    <span class="comment"># 初始化 侮辱性/非侮辱性 言论中 词条总个数</span></div><div class="line">    p0Denom = <span class="number">0.0</span></div><div class="line">    p1Denom = <span class="number">0.0</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(numTrainDocs):</div><div class="line">        <span class="keyword">if</span> trainCategory[i] == <span class="number">1</span>:</div><div class="line">            <span class="comment"># 如果为侮辱性言论，记录所有侮辱性词条向量累加之后的总向量</span></div><div class="line">            p1Num += trainMatrix[i]</div><div class="line">            <span class="comment"># 记录所有侮辱性言论中，总的词条个数</span></div><div class="line">            p1Denom += sum(trainMatrix[i])</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="comment"># 如果为非侮辱性言论，记录所有非侮辱性词条向量累加之后的总向量</span></div><div class="line">            p0Num += trainMatrix[i]</div><div class="line">            <span class="comment"># 记录所有非侮辱性言论中，总的词条个数</span></div><div class="line">            p0Denom += sum(trainMatrix[i])</div><div class="line"></div><div class="line">    <span class="comment"># 计算出一个标示每个词可能是侮辱性词汇概率的向量</span></div><div class="line">    p1Vect = p1Num / p1Denom</div><div class="line">    <span class="comment"># 计算出一个标示每个词可能是非侮辱性词汇概率的向量</span></div><div class="line">    p0Vect = p0Num / p0Denom</div><div class="line"></div><div class="line">    <span class="keyword">return</span> p0Vect, p1Vect, pAbusive</div></pre></td></tr></table></figure>
<p>运行代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">postingList, classVec = loadDataSet()</div><div class="line"></div><div class="line">vocabList = createVocabList(postingList)</div><div class="line"></div><div class="line"><span class="keyword">for</span> posting <span class="keyword">in</span> postingList:</div><div class="line">    word2Vec = setOfWords2Vec(vocabList, posting)</div><div class="line">    trainMat.append(word2Vec)</div><div class="line"></div><div class="line">p0V,p1V,pAb = trainNBO(trainMat,classVec)</div><div class="line"></div><div class="line">print(<span class="string">"------p0V------"</span>)</div><div class="line">print(p0V)</div><div class="line">print(<span class="string">"------p1V------"</span>)</div><div class="line">print(p1V)</div><div class="line">print(<span class="string">"------pAb------"</span>)</div><div class="line">print(pAb)</div></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">------p0V------</div><div class="line">[ <span class="number">0.04166667</span>  <span class="number">0.04166667</span>  <span class="number">0.04166667</span>  <span class="number">0.</span>          <span class="number">0.</span>          <span class="number">0.04166667</span></div><div class="line">  <span class="number">0.04166667</span>  <span class="number">0.04166667</span>  <span class="number">0.</span>          <span class="number">0.04166667</span>  <span class="number">0.04166667</span>  <span class="number">0.04166667</span></div><div class="line">  <span class="number">0.04166667</span>  <span class="number">0.</span>          <span class="number">0.</span>          <span class="number">0.08333333</span>  <span class="number">0.</span>          <span class="number">0.</span></div><div class="line">  <span class="number">0.04166667</span>  <span class="number">0.</span>          <span class="number">0.04166667</span>  <span class="number">0.04166667</span>  <span class="number">0.</span>          <span class="number">0.04166667</span></div><div class="line">  <span class="number">0.04166667</span>  <span class="number">0.04166667</span>  <span class="number">0.</span>          <span class="number">0.04166667</span>  <span class="number">0.</span>          <span class="number">0.04166667</span></div><div class="line">  <span class="number">0.04166667</span>  <span class="number">0.125</span>     ]</div><div class="line">------p1V------</div><div class="line">[ <span class="number">0.</span>          <span class="number">0.</span>          <span class="number">0.</span>          <span class="number">0.05263158</span>  <span class="number">0.05263158</span>  <span class="number">0.</span>          <span class="number">0.</span></div><div class="line">  <span class="number">0.</span>          <span class="number">0.05263158</span>  <span class="number">0.05263158</span>  <span class="number">0.</span>          <span class="number">0.</span>          <span class="number">0.</span></div><div class="line">  <span class="number">0.05263158</span>  <span class="number">0.05263158</span>  <span class="number">0.05263158</span>  <span class="number">0.05263158</span>  <span class="number">0.05263158</span>  <span class="number">0.</span></div><div class="line">  <span class="number">0.10526316</span>  <span class="number">0.</span>          <span class="number">0.05263158</span>  <span class="number">0.05263158</span>  <span class="number">0.</span>          <span class="number">0.10526316</span></div><div class="line">  <span class="number">0.</span>          <span class="number">0.15789474</span>  <span class="number">0.</span>          <span class="number">0.05263158</span>  <span class="number">0.</span>          <span class="number">0.</span>          <span class="number">0.</span>        ]</div><div class="line">------pAb------</div><div class="line"><span class="number">0.5</span></div></pre></td></tr></table></figure>
<p>p0V是所有词汇出现在非侮辱性言论中的概率向量。</p>
<p>p1V是所有词汇出现在侮辱性言论中的概率向量。</p>
<p>从中可以看出，p1V中，概率最大的是倒数第六个0.15789474,然后查询词条字典，发现这个词是‘stupid’,这意味着‘stupid’这个单词是最能表征类型1的词条，事实也确实如此。同时我们也能发现最能表征类别0的词条是‘him’。</p>
<p><code>从结果中我们同样也能看到，在p0V中为0的词条，在p1V中不为0，相反的，在p1V中为0的词条，在p0V中也不为0。其实这并不是绝对的，这是巧合所致，如果我们的测试样本数量足够大，就可以看出这个现象了。</code></p>
<h3 id="代码优化">代码优化</h3><p>代码实现了贝叶斯分类器，并不是完事大吉了，有些地方我们需要根据实际情况来优化我们的代码。</p>
<h4 id="注意点1：">注意点1：</h4><p>利用贝叶斯分类器对文档进行分类时，要计算多个概率的乘积，以获得文档属于某个类别的概率，即计算$p(w_0|1)p(w_1|1)p(w_2|1)$。如果其中一个概率为0，那么最后的成积也为0。为降低这种影响，可以将所有词的出现数初始化为1，并将分母初始化为2<code>(分子分母各加1)</code>。</p>
<p>将trainNBO()的14到18这几行代码进行修改：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 初始化 侮辱性/非侮辱性 言论中 词条分布总和向量</span></div><div class="line">   <span class="comment"># 引入numpy后,zeros(numWords)方法用来得到一个和numWords等长的单位矩阵</span></div><div class="line">   p0Num = ones(numWords)</div><div class="line">   p1Num = ones(numWords)</div><div class="line">   <span class="comment"># 初始化 侮辱性/非侮辱性 言论中 词条总个数</span></div><div class="line">   p0Denom = <span class="number">2.0</span></div><div class="line">   p1Denom = <span class="number">2.0</span></div></pre></td></tr></table></figure>
<h4 id="注意点2：">注意点2：</h4><p>另一个问题是下溢出，这是由于太多很小的数相乘造成的。当计算$p(w_0|c_i)p(w_1|c_i)p(w_2|c_i)…p(w_N|c_i)$时，由于大部分因子都非常小，所以非常容易出现下溢出<code>(可以尝试用python计算多个很小的数字相乘，最后的结果会变为0)</code>。</p>
<p>一种解决办法是对乘积取自然对数。在代数中有$ln(a*b)=ln(a)+ln(b)$,于是通过求对数可以将乘法转化为加法，从而避免下溢出或者浮点数舍入导致的错误。同时，采用自然对数进行处理不会有任何损失。</p>
<p>修改trainNBO()中的代码，在return之前添加如下代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 分别对每个元素取对数</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(p1Vect)):</div><div class="line">    p1Vect[i]=log(p1Vect[i])</div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(p0Vect)):</div><div class="line">    p0Vect[i]=log(p0Vect[i])</div></pre></td></tr></table></figure>
<h3 id="只差一步，构建朴素贝叶斯分类函数">只差一步，构建朴素贝叶斯分类函数</h3><p>现在已经准备好了构建完整的分类器了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># vec2Classify:待测试数据的词条向量</span></div><div class="line"><span class="comment"># pClass1:所有词条向量中是侮辱性词条向量的概率</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">classifyNB</span><span class="params">(vec2Classify, p0Vec, p1Vec, pClass1)</span>:</span></div><div class="line">	<span class="comment"># sum(vec2Classify * p1Vec)当前词条向量中，每个词条可能是侮辱性词条的概率之积p(w:c1)</span></div><div class="line">	<span class="comment"># pClass1 : p(c1)</span></div><div class="line">    p1 = sum(vec2Classify * p1Vec) + log(pClass1)</div><div class="line">    p0 = sum(vec2Classify * p0Vec) + log(<span class="number">1.0</span> - pClass1)</div><div class="line">    <span class="keyword">if</span> p1 &gt; p0:</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span></div></pre></td></tr></table></figure>
<p>执行代码，检验结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">postingList, classVec = loadDataSet()</div><div class="line">vocabList = createVocabList(postingList)</div><div class="line"></div><div class="line">trainMat = []</div><div class="line"></div><div class="line"><span class="keyword">for</span> posting <span class="keyword">in</span> postingList:</div><div class="line">    word2Vec = setOfWords2Vec(vocabList, posting)</div><div class="line">    trainMat.append(word2Vec)</div><div class="line"></div><div class="line">p0V,p1V,pAb = trainNBO(trainMat,classVec)</div><div class="line"></div><div class="line"><span class="comment"># 测试数据1</span></div><div class="line">testEntry = [<span class="string">'love'</span>,<span class="string">'my'</span>,<span class="string">'dalmation'</span>]</div><div class="line">thisDoc = array(setOfWords2Vec(vocabList,testEntry))</div><div class="line"><span class="keyword">print</span> testEntry,<span class="string">'classified as: '</span>,classifyNB(thisDoc,p0V,p1V,pAb)</div><div class="line"></div><div class="line"><span class="comment"># 测试数据2</span></div><div class="line">testEntry = [<span class="string">'stupid'</span>,<span class="string">'garbage'</span>]</div><div class="line">thisDoc = array(setOfWords2Vec(vocabList,testEntry))</div><div class="line"><span class="keyword">print</span> testEntry,<span class="string">'classified as: '</span>,classifyNB(thisDoc,p0V,p1V,pAb)</div></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[<span class="string">'love'</span>, <span class="string">'my'</span>, <span class="string">'dalmation'</span>] classified <span class="keyword">as</span>:  <span class="number">0</span></div><div class="line">[<span class="string">'stupid'</span>, <span class="string">'garbage'</span>] classified <span class="keyword">as</span>:  <span class="number">1</span></div></pre></td></tr></table></figure>
<h2 id="总结">总结</h2><p>至此，完成了朴素贝叶斯识别侮辱性言论的系统。对于分类而言，有的时候使用概率要比使用硬规则更为有效。可以看出，朴素贝叶斯提供了一种<strong>利用已知值来估计未知概率的有效方法</strong>。</p>
<p>虽然建立在<strong>特征独立性假设</strong>和<strong>特征同等重要假设</strong>之上，但是，贝叶斯分类器依然是一种很有效的分类器。</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">

      
      
        <h1 class="post-title" itemprop="name headline">
          
          
            
              <a class="post-title-link" href="/2015/12/13/机器学习(02)决策树/" itemprop="url">
                机器学习(02)决策树
              </a>
            
          
        </h1>
      

      <div class="post-meta">
        <span class="post-time">
          发表于
          <time itemprop="dateCreated" datetime="2015-12-13T20:08:55+08:00" content="2015-12-13">
            2015-12-13
          </time>
        </span>

        
          <span class="post-category" >
            &nbsp; | &nbsp; 分类于
            
              <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                <a href="/categories/机器学习/" itemprop="url" rel="index">
                  <span itemprop="name">机器学习</span>
                </a>
              </span>

              
              

            
          </span>
        

        
          
            <span class="post-comments-count">
              &nbsp; | &nbsp;
              <a href="/2015/12/13/机器学习(02)决策树/#comments" itemprop="discussionUrl">
                <span class="post-comments-count ds-thread-count" data-thread-key="2015/12/13/机器学习(02)决策树/" itemprop="commentsCount"></span>
              </a>
            </span>
          
        
      </div>
    </header>

    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody"><h2 id="什么是决策树">什么是决策树</h2><blockquote>
<p>你是否玩过二十个问题的游戏，游戏的规则很简单：参与游戏的一方在脑海里想某个事物，其他参与者向他提问题，只允许提20个问题，问题的答案也只能用对或错回答。问问题的人通过推断分解，逐步缩小待猜测事物的范围。</p>
</blockquote>
<p>决策树的工作原理与20个问题类似，用户输入一系列数据，然后给出游戏的答案。</p>
<p>决策树的概念非常简单。如下图就是一个决策树：</p>
<p><img src="/img/ml_02_01.png" alt="决策树图例"></p>
<p>构造决策树能够读取数据集合，并从中提取出一系列规则。</p>
<p>专家系统中经常使用决策树，而且决策树给出结果往往可以匹敌在当前领域具有几十年工作经验的人类专家。</p>
<h3 id="决策树的优缺点">决策树的优缺点</h3><blockquote>
<p>优点：计算复杂度不高，输出结果易于理解，对中间值的缺失不敏感，可以处理不相关特征数据。</p>
<p>缺点：可能会产生过渡匹配的问题。</p>
<p>使用数据类型：数值型和标称型。</p>
</blockquote>
<h2 id="决策树算法">决策树算法</h2><h3 id="实施决策树算法的步骤：">实施决策树算法的步骤：</h3><ul>
<li><p>1.收集数据</p>
</li>
<li><p>2.处理数据，保证每条数据的最末尾的数据是当前类型。</p>
</li>
<li><p>3.对多个可以划分的<strong>特征</strong>进行甄选，甄选的标准是<strong>保证通过甄选之后划分的结果的信息增益最大</strong>。划分的方式:按照当前甄选的特征进行划分。</p>
</li>
</ul>
<blockquote>
<p>比如影响是否是鱼类的类型的两个特征：不浮出水面是否可以生存，是否有脚蹼，若当前选择的特征“不浮出水面是否可以生存” 信息增益最大，那么将数据划分成：不浮出水面可以生存 和 不浮出水面不可以生存 两类数据。</p>
</blockquote>
<ul>
<li>4.如果划分后的数据全是同一类型（即香浓熵为0），则不再划分，否则，继续递归调用第三步的方法。</li>
</ul>
<h3 id="分析">分析</h3><p>在构造决策树时，我们需要解决的第一个问题就是，<strong>当数据集上哪个特征在划分数据分类时起决定性作用</strong>。为了找到<strong>决定性</strong>的特征，划分出<strong>最好</strong>的结果，我们必须<strong>评估每个特征</strong>。</p>
<p>完成测试之后，原始数据集就被划分为几个<strong>数据子集</strong>。这些数据子集会分布在第一个<strong>决策点</strong>的所有分支上。</p>
<p>如果某个分支下的数据属于同一类型，则当前分支下数据已经正确地划分，无需进行进一步对数据集进行分割。如果分支下的数据不属于同一类型，则需要重复划分数据子集，直到<strong>所有具有相同类型的数据均在一个数据子集内</strong>。</p>
<p>伪代码实现：</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">检测数据集中的每个子项是否属于同一分类</div><div class="line"><span class="keyword">If</span> <span class="keyword">so</span> <span class="keyword">return</span> 类标签;</div><div class="line"><span class="keyword">Else</span></div><div class="line">     寻找划分数据集的最好特征</div><div class="line">     划分数据集</div><div class="line">     创建分支节点</div><div class="line">          <span class="keyword">for</span> 每个划分的子集</div><div class="line">               ＃ 递归调用函数createBranch</div><div class="line">               调用函数createBranch并增加返回结果到分支节点中</div><div class="line">     <span class="keyword">return</span> 分支节点</div></pre></td></tr></table></figure>
<h3 id="核心算法介绍">核心算法介绍</h3><p><strong>划分算法</strong>：</p>
<p>主要参考<strong>ID3算法</strong>,每次划分数据集时只选取一个特征属性:</p>
<p><a href="http://en.wikipedia.org/wiki/ID3_algorithm" target="_blank" rel="external">http://en.wikipedia.org/wiki/ID3_algorithm</a></p>
<p><strong>香浓熵</strong></p>
<blockquote>
<p><strong>克劳德·香农</strong><br>克劳德·香农被公认为是二十世纪最聪明的人之一，威廉·庞德斯通在其2005年出版的《财富公式》一书中是这样描写克劳德·香农的：</p>
<p>“贝尔实验室和MIT有很多人将香农和爱因斯坦相提并论，而其他人则认为这种对比是不公平的－－对香农是不公平的。”</p>
</blockquote>
<p>划分数据集的大原则是：<strong>将无需的数据变得更加有序</strong>。组织杂乱无章的数据的一种方法就是使用<strong>信息论</strong>度量信息，信息论是量化处理信息的分支学科。</p>
<p><code>在划分数据前后信息发生的变化称为信息增益。</code></p>
<p><strong>熵</strong>定义为<strong>信息的期望值</strong>，首先我们需要知道<strong>信息的定义</strong>。如果待分类的事务可能划分在多个分类之中，则<strong>符号$x_i$的信息</strong>定义为：</p>
<p> $$l(n_i) = -log_2p(x_i)$$</p>
<p> 其中$p(x_i)$是选择该分类的概率。</p>
<p> 为了计算<strong>熵</strong>，我们需要计算<strong>所有类别所有可能值包含的信息期望值</strong>，通过下面公式得到：</p>
<p> $$H = -\sum_{i=1}^np(x_i)log_2p(x_i)$$</p>
<p> 其中n是分类的数目。</p>
<h2 id="说这么多，不如举个栗子来的实在">说这么多，不如举个栗子来的实在</h2><p>接下来我们对下列数据通过决策树来进行分析：</p>
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:center">不浮出水面是否可以生存</th>
<th style="text-align:center">是否有脚蹼</th>
<th style="text-align:center">属于鱼类</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:center">是</td>
<td style="text-align:center">是</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:center">是</td>
<td style="text-align:center">是</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:center">是</td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:center">否</td>
<td style="text-align:center">是</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:center">否</td>
<td style="text-align:center">是</td>
<td style="text-align:center">否</td>
</tr>
</tbody>
</table>
<h3 id="上代码">上代码</h3><blockquote>
<p>对数据进行分类时，我们首先要思考按照哪一个特征分类。这里我们需要分别计算分别按照两个特征进行分类之后的香浓熵，与分类之前的香浓熵进行对比，选取差值最大的（即为信息增益最大的）结果作为分类标准。</p>
</blockquote>
<p>模拟获取数据，注意数据的最末尾是当<strong>前数据的类型</strong>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">createDataSet</span><span class="params">()</span>:</span></div><div class="line">    dataSet = [[<span class="number">1</span>,<span class="number">1</span>,<span class="string">'yes'</span>],</div><div class="line">               [<span class="number">1</span>,<span class="number">1</span>,<span class="string">'yes'</span>],</div><div class="line">               [<span class="number">1</span>,<span class="number">0</span>,<span class="string">'no'</span>],</div><div class="line">               [<span class="number">0</span>,<span class="number">1</span>,<span class="string">'no'</span>],</div><div class="line">               [<span class="number">0</span>,<span class="number">1</span>,<span class="string">'no'</span>]]</div><div class="line">    labels = [<span class="string">'no surfacing'</span>,<span class="string">'flippers'</span>]</div><div class="line">    <span class="keyword">return</span> dataSet,labels</div></pre></td></tr></table></figure>
<p>传说中香农熵的计算：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> math <span class="keyword">import</span> log</div><div class="line"></div><div class="line"><span class="comment"># 计算数据中最后一个元素（当前数据类型）的香农熵</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">calcShannonEnt</span><span class="params">(dataSet)</span>:</span></div><div class="line">    numEntries = len(dataSet)</div><div class="line">    labelCounts = &#123;&#125;</div><div class="line">    <span class="keyword">for</span> featVec <span class="keyword">in</span> dataSet:</div><div class="line">        currentLabel = featVec[<span class="number">-1</span>]</div><div class="line">        <span class="keyword">if</span> currentLabel <span class="keyword">not</span> <span class="keyword">in</span> labelCounts.keys():</div><div class="line">            labelCounts[currentLabel] = <span class="number">0</span></div><div class="line">        labelCounts[currentLabel] += <span class="number">1</span></div><div class="line"></div><div class="line">    shannonEnt = <span class="number">0.0</span></div><div class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> labelCounts:</div><div class="line">        prob = float(labelCounts[key])/numEntries</div><div class="line">        shannonEnt -= prob * log(prob,<span class="number">2</span>)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> shannonEnt</div></pre></td></tr></table></figure>
<p>对数据进行分割：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># dataSet:传入数据  </span></div><div class="line"><span class="comment"># axis:要进行切割的特征下标  </span></div><div class="line"><span class="comment"># value:用来切割的特征值</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">splitDataSet</span><span class="params">(dataSet, axis, value)</span>:</span></div><div class="line">    retDataSet = []</div><div class="line">    <span class="keyword">for</span> featVec <span class="keyword">in</span> dataSet:</div><div class="line">        <span class="keyword">if</span> featVec[axis] == value:</div><div class="line">            reducedFeatVec = featVec[:axis]</div><div class="line">            reducedFeatVec.extend(featVec[axis+<span class="number">1</span>:])</div><div class="line">            retDataSet.append(reducedFeatVec)</div><div class="line">    <span class="keyword">return</span> retDataSet</div></pre></td></tr></table></figure>
<p>甄选最适合划分的特征：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">chooseBestFeatureToSplit</span><span class="params">(dataSet)</span>:</span></div><div class="line">    <span class="comment"># 获取每组数据除去分类标签的数据长度</span></div><div class="line">    numFeatures = len(dataSet[<span class="number">0</span>]) - <span class="number">1</span></div><div class="line">    <span class="comment"># 计算数据的基础的shannon熵</span></div><div class="line">    baseEntropy = calcShannonEnt(dataSet)</div><div class="line">    bestInfoGain = <span class="number">0.0</span></div><div class="line">    bestFeature = <span class="number">-1</span></div><div class="line">    print(dataSet)</div><div class="line">    print(<span class="string">"------"</span> + str(numFeatures))</div><div class="line"></div><div class="line">    <span class="comment"># 遍历每一列标签</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(numFeatures):</div><div class="line">        <span class="comment"># 获取每一种标签下的对应的数据</span></div><div class="line">        featList = [example[i] <span class="keyword">for</span> example <span class="keyword">in</span> dataSet]</div><div class="line">        <span class="keyword">print</span> featList</div><div class="line">        uniqueVals = set(featList)</div><div class="line">        newEntropy = <span class="number">0.0</span></div><div class="line"></div><div class="line">        <span class="comment"># 遍历并按照分类分割这一列下的数据 并计算分割后的shannone熵</span></div><div class="line">        <span class="keyword">for</span> value <span class="keyword">in</span> uniqueVals:</div><div class="line">            subDataSet = splitDataSet(dataSet,i,value)</div><div class="line">            prob = len(subDataSet)/float(len(dataSet))</div><div class="line">            print(<span class="string">"shannone:"</span> + str(calcShannonEnt(subDataSet)))</div><div class="line">            newEntropy += prob * calcShannonEnt(subDataSet)</div><div class="line"></div><div class="line">        <span class="comment"># 之前基本的shannone熵 减去 分割后的数据的shannone熵 算出前后差值 差值越大，代表后面的分类中，分得的数据混杂项越少</span></div><div class="line">        infoGain = baseEntropy - newEntropy</div><div class="line">        <span class="keyword">if</span> infoGain &gt; bestInfoGain:</div><div class="line">            bestInfoGain = infoGain</div><div class="line">            bestFeature = i</div><div class="line">    <span class="keyword">return</span> bestFeature</div></pre></td></tr></table></figure>
<p>执行结果：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>myDat,labels=createDataSet()</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>chooseBestFeatureToSplit(myDat)</div><div class="line"><span class="number">0</span></div></pre></td></tr></table></figure>
<p>得到最好的分类是第0个特征。</p>
</span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/7/">&laquo;</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/9/">&raquo;</a>
  </nav>

 </div>

        

        
      </div>

      
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      <section class="site-overview">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="http://dannylee1991.github.io/images/avatar.jpg" alt="DannyLee佳楠" itemprop="image"/>
          <p class="site-author-name" itemprop="name">DannyLee佳楠</p>
        </div>
        <p class="site-description motion-element" itemprop="description">一只在迈向机器学习道路上狂奔的程序猿.</p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">98</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">16</span>
              <span class="site-state-item-name">分类</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">18</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/DannyLee1991" target="_blank">GitHub</a>
              </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element" itemprop="license">
            <a href="http://creativecommons.org/licenses/by-nc-sa/4.0" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner"> <div class="copyright" >
  
  &copy; &nbsp; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="icon-next-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">DannyLee佳楠</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT
  </a>
</div>


 </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  
  
    

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"dannylee1991"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>
    
     
  	<script src="/js/ua-parser.min.js"></script>
  	<script src="/js/hook-duoshuo.js"></script>
  

    
  
  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.1"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.1"></script>
  

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/js/motion_global.js?v=0.4.5.1" id="motion.global"></script>




  <script type="text/javascript" src="/js/nav-toggle.js?v=0.4.5.1"></script>
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  

  <script type="text/javascript">
    $(document).ready(function () {
      if (CONFIG.sidebar === 'always') {
        displaySidebar();
      }
      if (isMobile()) {
        FastClick.attach(document.body);
      }
    });
  </script>

  

  
  

  
  <script type="text/javascript" src="/js/lazyload.js"></script>
  <script type="text/javascript">
    $(function () {
      $("#posts").find('img').lazyload({
        placeholder: "/images/loading.gif",
        effect: "fadeIn"
      });
    });
  </script>
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</body>
</html>
